## –°–≤–µ—Ä—Ç–æ—á–Ω–∞—è –Ω–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å (convolutional neural network)

–°–≤–µ—Ä—Ç–æ—á–Ω–∞—è –Ω–µ–π—Ä–æ—Å–µ—Ç—å (CNN) ‚Äî —ç—Ç–æ —Ç–∏–ø –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–π –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏, –∫–æ—Ç–æ—Ä—ã–π –æ—Å–æ–±–µ–Ω–Ω–æ —Ö–æ—Ä–æ—à –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏. –ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —Ç—ã —Å–º–æ—Ç—Ä–∏—à—å –Ω–∞ –∫–∞—Ä—Ç–∏–Ω—É, –∏ —Ç–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äî –ø–æ–Ω—è—Ç—å, —á—Ç–æ –Ω–∞ –Ω–µ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–æ. –°–Ω–∞—á–∞–ª–∞ —Ç—ã –º–æ–∂–µ—à—å –∑–∞–º–µ—Ç–∏—Ç—å –∫—Ä—É–ø–Ω—ã–µ –¥–µ—Ç–∞–ª–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Ü–≤–µ—Ç –∏–ª–∏ —Ñ–æ—Ä–º—ã, –∞ –∑–∞—Ç–µ–º, –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ, —Ä–∞–∑–±–∏—Ä–∞—Ç—å—Å—è –≤ –±–æ–ª–µ–µ –º–µ–ª–∫–∏—Ö —á–∞—Å—Ç—è—Ö, —Ç–∞–∫–∏—Ö –∫–∞–∫ —Ç–µ–∫—Å—Ç—É—Ä—ã –∏–ª–∏ –≥—Ä–∞–Ω–∏—Ü—ã –æ–±—ä–µ–∫—Ç–æ–≤.

–°–≤–µ—Ä—Ç–æ—á–Ω—ã–µ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –ø–æ —Å—Ö–æ–∂–µ–º—É –ø—Ä–∏–Ω—Ü–∏–ø—É. –û–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å–≤–µ—Ä—Ç–∫–∏, —á—Ç–æ–±—ã "—Ä–∞–∑–±–∏–≤–∞—Ç—å" –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –Ω–µ–±–æ–ª—å—à–∏–µ —É—á–∞—Å—Ç–∫–∏ –∏ –∏—Å–∫–∞—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ –∫—Ä–∞—è, —É–≥–ª—ã, —Ç–µ–∫—Å—Ç—É—Ä—ã –∏ –¥—Ä—É–≥–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏. –° –∫–∞–∂–¥—ã–º —Å–ª–æ–µ–º —Å–µ—Ç–∏ —ç—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –≤—Å—ë –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–º–∏, –∏ –≤ –∏—Ç–æ–≥–µ —Å–µ—Ç—å –º–æ–∂–µ—Ç —Ç–æ—á–Ω–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–ª–∏ –¥–µ–ª–∞—Ç—å –¥—Ä—É–≥–∏–µ –∑–∞–¥–∞—á–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤).

–ì–ª–∞–≤–Ω–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å —Ç–∞–∫–∏—Ö —Å–µ—Ç–µ–π ‚Äî —ç—Ç–æ —Å–≤–µ—Ä—Ç–æ—á–Ω—ã–µ —Å–ª–æ–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥–∞—é—Ç —Å–µ—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–≤–ª–µ–∫–∞—Ç—å –≤–∞–∂–Ω—ã–µ –¥–µ—Ç–∞–ª–∏ –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –Ω–µ —Ç—Ä–µ–±—É—è –æ—Ç –Ω–∞—Å –º–Ω–æ–≥–æ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞–Ω–∏–π.

### **–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–¥–∞**

–≠—Ç–æ—Ç –∫–æ–¥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–¥–∞—á—É –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≥–ª–∞–∑ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–≤–µ—Ä—Ç–æ—á–Ω–æ–π –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ (CNN) –≤ TensorFlow. –†–∞–∑–±–µ—Ä–µ–º –µ–≥–æ –ø–æ—ç—Ç–∞–ø–Ω–æ.

---

## **1. –ò–º–ø–æ—Ä—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫**
```python
import os
import pathlib
import zipfile

import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import tensorflow as tf
from sklearn.metrics import confusion_matrix, classification_report
```
### **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫:**
- `os`, `pathlib`, `zipfile` ‚Äî —Ä–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π (–ø–æ–∏—Å–∫ —Ñ–∞–π–ª–æ–≤, –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ, —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∞ ZIP).
- `numpy` ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –º–∞—Å—Å–∏–≤–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö.
- `matplotlib.pyplot`, `seaborn` ‚Äî –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ (–≤–∫–ª—é—á–∞—è –º–∞—Ç—Ä–∏—Ü—É –ø—É—Ç–∞–Ω–Ω–æ—Å—Ç–∏).
- `tensorflow` ‚Äî —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –æ–±—É—á–µ–Ω–∏–µ –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–π.
- `sklearn.metrics` ‚Äî –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–º–∞—Ç—Ä–∏—Ü–∞ –ø—É—Ç–∞–Ω–Ω–æ—Å—Ç–∏ –∏ –æ—Ç—á—ë—Ç –ø–æ –º–µ—Ç—Ä–∏–∫–∞–º).

---

## **2. –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**
```python
def rename_images_in_directory(directory, prefix="img"):
    """
    –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ—Ç –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏ –µ—ë –ø–æ–¥–ø–∞–ø–∫–∞—Ö,
    –ø—Ä–∏—Å–≤–∞–∏–≤–∞—è –∏–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ "img_–Ω–æ–º–µ—Ä.—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ".
    """
    if not os.path.isdir(directory):
        print(f"–û—à–∏–±–∫–∞: –ü–∞–ø–∫–∞ '{directory}' –Ω–µ –Ω–∞–π–¥–µ–Ω–∞.")
        return

    image_extensions = {'.jpg', '.jpeg', '.png', '.gif', '.bmp', '.tiff', '.webp'}
    image_files = []

    # –ü–æ–∏—Å–∫ –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –ø–∞–ø–∫–µ –∏ –µ—ë –ø–æ–¥–ø–∞–ø–∫–∞—Ö
    for root, _, files in os.walk(directory):
        for file in files:
            if os.path.splitext(file)[1].lower() in image_extensions:
                image_files.append(os.path.join(root, file))

    # –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Ñ–∞–π–ª–æ–≤ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞ –Ω—É–º–µ—Ä–∞—Ü–∏–∏
    image_files.sort()

    # –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
    for index, old_path in enumerate(image_files, start=1):
        directory, filename = os.path.split(old_path)
        ext = os.path.splitext(filename)[1]
        new_name = f"{prefix}_{index}{ext}"
        new_path = os.path.join(directory, new_name)

        if old_path != new_path:
            os.rename(old_path, new_path)
            print(f"Renamed: {old_path} -> {new_path}")
```
### **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è?**
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —É–∫–∞–∑–∞–Ω–Ω–∞—è –ø–∞–ø–∫–∞.
2. –°–æ–±–∏—Ä–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏ –µ—ë –ø–æ–¥–ø–∞–ø–∫–∞—Ö.
3. –°–æ—Ä—Ç–∏—Ä—É–µ—Ç —Ñ–∞–π–ª—ã –¥–ª—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –Ω—É–º–µ—Ä–∞—Ü–∏–∏.
4. –ü—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç —Ñ–∞–π–ª–∞–º –Ω–æ–≤—ã–µ –∏–º–µ–Ω–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ `img_–Ω–æ–º–µ—Ä.—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ`.
5. –í—ã–ø–æ–ª–Ω—è–µ—Ç –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ.

---

## **3. –ó–∞–≥—Ä—É–∑–∫–∞ –∏ —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö**
```python
Type_of_eyes_url = (
    "https://drive.google.com/uc?export=download&id=1nsD3EqrTYl_GE2WO7dloJ6QSyNQGtzfq"
)

zip_path = tf.keras.utils.get_file('Type_of_eyes.zip', origin=Type_of_eyes_url, extract=False)
print(f"Zip file downloaded to: {zip_path}")
```
### **–ß—Ç–æ –∑–¥–µ—Å—å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç?**
- –°—Å—ã–ª–∫–∞ `Type_of_eyes_url` —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –∞—Ä—Ö–∏–≤ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –≥–ª–∞–∑, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω—ã–π –Ω–∞ Google Drive.
- `tf.keras.utils.get_file()` —Å–∫–∞—á–∏–≤–∞–µ—Ç ZIP-–∞—Ä—Ö–∏–≤ –≤ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –º–µ—Å—Ç–æ.

---

### **4. –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ –∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤**
```python
extracted_path = pathlib.Path(zip_path).parent / "Type_of_eyes"

if not extracted_path.is_dir():
    with zipfile.ZipFile(zip_path, 'r') as zip_ref:
        zip_ref.extractall(extracted_path)
    print(f"Files extracted to: {extracted_path}")
    rename_images_in_directory(extracted_path)
```
### **–ß—Ç–æ –∑–¥–µ—Å—å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç?**
- –°–æ–∑–¥–∞–µ—Ç—Å—è –ø—É—Ç—å –¥–ª—è —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∏ –∞—Ä—Ö–∏–≤–∞.
- –ï—Å–ª–∏ –ø–∞–ø–∫–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∞.
- –ó–∞—Ç–µ–º –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è `rename_images_in_directory()`, —á—Ç–æ–±—ã —Ñ–∞–π–ª—ã –∏–º–µ–ª–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–º–µ–Ω–∞.

---

## **5. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è**
```python
data_dir = pathlib.Path(f"{extracted_path}/Type_of_eyes")

# –†–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
img_height, img_width = 180, 180
batch_size = 32
```
- `data_dir` —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø–∞–ø–∫—É, –≥–¥–µ –ª–µ–∂–∞—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, —Ä–∞–∑–¥–µ–ª—ë–Ω–Ω—ã–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º.
- `img_height`, `img_width` ‚Äî —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –æ–Ω–∏ –±—É–¥—É—Ç –ø—Ä–∏–≤–µ–¥–µ–Ω—ã.
- `batch_size` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –æ–¥–Ω–æ–π –ø–∞—Ä—Ç–∏–∏ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è.

---

## **6. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–æ—Ä–º–∞—Ç–µ TensorFlow Dataset**
```python
train_ds = tf.keras.preprocessing.image_dataset_from_directory(
    data_dir,
    validation_split=0.2,
    subset="training",
    seed=123,
    image_size=(img_height, img_width),
    batch_size=batch_size,
)

val_ds = tf.keras.preprocessing.image_dataset_from_directory(
    data_dir,
    validation_split=0.2,
    subset="validation",
    seed=123,
    image_size=(img_height, img_width),
    batch_size=batch_size,
)
```
- –î–∞—Ç–∞—Å–µ—Ç —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π.
- `validation_split=0.2` ‚Äî 80% –¥–∞–Ω–Ω—ã—Ö –∏–¥—ë—Ç –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ, 20% ‚Äî –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—é.
- `seed=123` —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç —Å–ª—É—á–∞–π–Ω–æ—Å—Ç—å –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏.

---

## **7. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**
```python
normalization_layer = tf.keras.layers.Rescaling(1.0 / 255)

train_ds = train_ds.map(lambda x, y: (normalization_layer(x), y))
val_ds = val_ds.map(lambda x, y: (normalization_layer(x), y))
```
- –í—Å–µ –ø–∏–∫—Å–µ–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø–µ—Ä–µ–≤–æ–¥—è—Ç—Å—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω `[0,1]`, —á—Ç–æ–±—ã —É–ª—É—á—à–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏.

---

## **8. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö**
```python
AUTOTUNE = tf.data.AUTOTUNE
train_ds = train_ds.cache().shuffle(1000).prefetch(buffer_size=AUTOTUNE)
val_ds = val_ds.cache().prefetch(buffer_size=AUTOTUNE)
```
- `cache()` –∫—ç—à–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ, —á—Ç–æ–±—ã —É—Å–∫–æ—Ä–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ.
- `shuffle(1000)` –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è.
- `prefetch(AUTOTUNE)` –ø–æ–¥–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∑–∞—Ä–∞–Ω–µ–µ.

---

## **9. –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ CNN**
```python
model = tf.keras.Sequential([
    tf.keras.layers.Conv2D(32, (3, 3), activation='relu', input_shape=(img_height, img_width, 3)),
    tf.keras.layers.MaxPooling2D(),
    tf.keras.layers.Conv2D(64, (3, 3), activation='relu'),
    tf.keras.layers.MaxPooling2D(),
    tf.keras.layers.Conv2D(128, (3, 3), activation='relu'),
    tf.keras.layers.MaxPooling2D(),
    tf.keras.layers.Flatten(),
    tf.keras.layers.Dense(128, activation='relu'),
    tf.keras.layers.Dense(len(class_names), activation='softmax'),
])
```
- 3 —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö —Å–ª–æ—è —Å —É–≤–µ–ª–∏—á–∏–≤–∞—é—â–∏–º—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ñ–∏–ª—å—Ç—Ä–æ–≤.
- –§—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ `ReLU`.
- `MaxPooling2D()` —É–º–µ–Ω—å—à–∞–µ—Ç —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –∫–∞—Ä—Ç –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.
- `Flatten()` –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç 2D-–¥–∞–Ω–Ω—ã–µ –≤ –≤–µ–∫—Ç–æ—Ä.
- `Dense(128)` ‚Äî –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–π —Å–ª–æ–π.
- `Dense(len(class_names), activation='softmax')` ‚Äî –≤—ã—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è–º–∏ –∫–ª–∞—Å—Å–æ–≤.

---

## **10. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏**
```python
model.compile(optimizer='adam', loss='sparse_categorical_crossentropy', metrics=['accuracy'])
epochs = 10
history = model.fit(train_ds, validation_data=val_ds, epochs=epochs)
```
- `adam` ‚Äî –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä.
- `sparse_categorical_crossentropy` ‚Äî —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å.
- `epochs=10` ‚Äî —á–∏—Å–ª–æ —ç–ø–æ—Ö.

---

## **11. –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏**
```python
y_true = []
y_pred = []

for images, labels in val_ds:
    preds = model.predict(images)
    y_true.extend(labels.numpy())
    y_pred.extend(np.argmax(preds, axis=1))
```
- –°–æ–±–∏—Ä–∞–µ–º —Ä–µ–∞–ª—å–Ω—ã–µ (`y_true`) –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ (`y_pred`) –∫–ª–∞—Å—Å—ã.

---

## **12. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã –ø—É—Ç–∞–Ω–Ω–æ—Å—Ç–∏**
```python
conf_mat = confusion_matrix(y_true, y_pred)
sns.heatmap(conf_mat, annot=True, fmt="d", cmap="Blues", xticklabels=class_names, yticklabels=class_names)
plt.show()
```
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –æ—à–∏–±–æ–∫ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏.

---

## **13. –í—ã–≤–æ–¥ –æ—Ç—á—ë—Ç–∞**
```python
print(classification_report(y_true, y_pred, target_names=class_names))
```
- –¢–æ—á–Ω–æ—Å—Ç—å, –ø–æ–ª–Ω–æ—Ç–∞ –∏ F1-–º–µ—Ç—Ä–∏–∫–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞.

### **–ü–æ–¥—Ä–æ–±–Ω–æ–µ –ø–æ—Å—Ç—Ä–æ—á–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –∫–æ–¥–∞**

–≠—Ç–æ—Ç –∫–æ–¥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–¥–∞—á—É –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≥–ª–∞–∑, –∏—Å–ø–æ–ª—å–∑—É—è —Å–≤–µ—Ä—Ç–æ—á–Ω—É—é –Ω–µ–π—Ä–æ–Ω–Ω—É—é —Å–µ—Ç—å (CNN) –≤ TensorFlow. –†–∞–∑–±–µ—Ä–µ–º –∫–æ–¥ **–ø–æ—Å—Ç—Ä–æ—á–Ω–æ –∏ –ø–æ –±–ª–æ–∫–∞–º**, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å –∫–∞–∂–¥—É—é –æ–ø–µ—Ä–∞—Ü–∏—é.

---

## **1. –ò–º–ø–æ—Ä—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫**
```python
import os
import pathlib
import zipfile

import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import tensorflow as tf
from sklearn.metrics import confusion_matrix, classification_report
```
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞?**
- `import os` ‚Äî –º–æ–¥—É–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π (–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ, –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –∏ —Ñ–∞–π–ª–æ–≤).
- `import pathlib` ‚Äî —É–¥–æ–±–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –ø—É—Ç—è–º–∏ —Ñ–∞–π–ª–æ–≤ –∏ –ø–∞–ø–æ–∫ –≤ –∫—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ.
- `import zipfile` ‚Äî –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞—Ç—å `.zip` —Ñ–∞–π–ª—ã.
- `import numpy as np` ‚Äî `NumPy` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–º–∏ –º–∞—Å—Å–∏–≤–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö.
- `import matplotlib.pyplot as plt` ‚Äî –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤.
- `import seaborn as sns` ‚Äî –±–æ–ª–µ–µ —É–¥–æ–±–Ω–∞—è –∏ –∫—Ä–∞—Å–∏–≤–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –º–∞—Ç—Ä–∏—Ü—ã –ø—É—Ç–∞–Ω–Ω–æ—Å—Ç–∏).
- `import tensorflow as tf` ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–µ–π—Ä–æ—Å–µ—Ç—è–º–∏.
- `from sklearn.metrics import confusion_matrix, classification_report`  
  - `confusion_matrix` ‚Äî —Å—Ç—Ä–æ–∏—Ç –º–∞—Ç—Ä–∏—Ü—É –æ—à–∏–±–æ–∫ –º–æ–¥–µ–ª–∏.
  - `classification_report` ‚Äî —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç—å (precision), –ø–æ–ª–Ω–æ—Ç—É (recall) –∏ F1-–º–µ—Ç—Ä–∏–∫–∏.

---

## **2. –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**
```python
def rename_images_in_directory(directory, prefix="img"):
```
- –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é `rename_images_in_directory`, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–≤–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞:
  - `directory` ‚Äî –ø—É—Ç—å –∫ –ø–∞–ø–∫–µ, –≥–¥–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
  - `prefix="img"` ‚Äî –ø—Ä–µ—Ñ–∏–∫—Å, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –∫ –∫–∞–∂–¥–æ–º—É –Ω–æ–≤–æ–º—É –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞.

```python
    if not os.path.isdir(directory):
        print(f"–û—à–∏–±–∫–∞: –ü–∞–ø–∫–∞ '{directory}' –Ω–µ –Ω–∞–π–¥–µ–Ω–∞.")
        return
```
- –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –ø–∞–ø–∫–∞ `directory`. –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –≤—ã–≤–æ–¥–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –∏ –∑–∞–≤–µ—Ä—à–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ.

```python
    image_extensions = {'.jpg', '.jpeg', '.png', '.gif', '.bmp', '.tiff', '.webp'}
    image_files = []
```
- `image_extensions` —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ø–∏—Å–æ–∫ –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.
- `image_files = []` —Å–æ–∑–¥–∞—ë—Ç –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—É—Ç–µ–π –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º.

```python
    for root, _, files in os.walk(directory):
        for file in files:
            if os.path.splitext(file)[1].lower() in image_extensions:
                image_files.append(os.path.join(root, file))
```
- `os.walk(directory)` —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ –≤—Å–µ–º —Ñ–∞–π–ª–∞–º –≤ –ø–∞–ø–∫–µ `directory` –∏ –µ—ë –ø–æ–¥–ø–∞–ø–∫–∞—Ö.
- `os.path.splitext(file)[1].lower()` –ø–æ–ª—É—á–∞–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –≤ –Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ.
- –ï—Å–ª–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –µ—Å—Ç—å –≤ `image_extensions`, –¥–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –≤ `image_files`.

```python
    image_files.sort()
```
- –°–æ—Ä—Ç–∏—Ä—É–µ–º —Ñ–∞–π–ª—ã –ø–æ –∏–º–µ–Ω–∏, —á—Ç–æ–±—ã –æ–±–µ—Å–ø–µ—á–∏—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –ø–æ—Ä—è–¥–æ–∫ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è.

```python
    for index, old_path in enumerate(image_files, start=1):
        directory, filename = os.path.split(old_path)
        ext = os.path.splitext(filename)[1]
        new_name = f"{prefix}_{index}{ext}"
        new_path = os.path.join(directory, new_name)

        if old_path != new_path:
            os.rename(old_path, new_path)
            print(f"Renamed: {old_path} -> {new_path}")
```
- –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ —Ñ–∞–π–ª–∞–º, –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ–º –∏—Ö –≤ —Ñ–æ—Ä–º–∞—Ç–µ `img_–Ω–æ–º–µ—Ä.—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ` (`img_1.jpg`, `img_2.jpg`, ...).
- –ï—Å–ª–∏ –Ω–æ–≤–æ–µ –∏–º—è –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç —Å—Ç–∞—Ä–æ–≥–æ ‚Äî –≤—ã–ø–æ–ª–Ω—è–µ–º –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ.

---

## **3. –ó–∞–≥—Ä—É–∑–∫–∞ –∏ —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∞ ZIP-—Ñ–∞–π–ª–∞**
```python
Type_of_eyes_url = (
    "https://drive.google.com/uc?export=download&id=1nsD3EqrTYl_GE2WO7dloJ6QSyNQGtzfq"
)
```
- –£–∫–∞–∑—ã–≤–∞–µ–º URL –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –∞—Ä—Ö–∏–≤–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏.

```python
zip_path = tf.keras.utils.get_file('Type_of_eyes.zip', origin=Type_of_eyes_url, extract=False)
print(f"Zip file downloaded to: {zip_path}")
```
- –°–∫–∞—á–∏–≤–∞–µ–º —Ñ–∞–π–ª —Å –ø–æ–º–æ—â—å—é `tf.keras.utils.get_file()`, —Å–æ—Ö—Ä–∞–Ω—è—è –µ–≥–æ –≤ `zip_path`.
- –í—ã–≤–æ–¥–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –ø—É—Ç–∏ —Å–∫–∞—á–∞–Ω–Ω–æ–≥–æ –∞—Ä—Ö–∏–≤–∞.

```python
extracted_path = pathlib.Path(zip_path).parent / "Type_of_eyes"

if not extracted_path.is_dir():
    with zipfile.ZipFile(zip_path, 'r') as zip_ref:
        zip_ref.extractall(extracted_path)
    print(f"Files extracted to: {extracted_path}")
    rename_images_in_directory(extracted_path)
```
- –û–ø—Ä–µ–¥–µ–ª—è–µ–º `extracted_path`, –≥–¥–µ –±—É–¥—É—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è —Ä–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã.
- –ï—Å–ª–∏ –ø–∞–ø–∫–∞ `extracted_path` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç:
  - –†–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ–º –∞—Ä—Ö–∏–≤ —Å –ø–æ–º–æ—â—å—é `zipfile.ZipFile()`.
  - –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.

---

## **4. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è TensorFlow**
```python
data_dir = pathlib.Path(f"{extracted_path}/Type_of_eyes")
```
- –£–∫–∞–∑—ã–≤–∞–µ–º –ø—É—Ç—å –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏.

```python
img_height, img_width = 180, 180
batch_size = 32
```
- –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –ø—Ä–∏–≤–µ–¥–µ–Ω–∏—è –∫ –µ–¥–∏–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É.
- `batch_size=32` ‚Äî —Å–∫–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –∑–∞ —Ä–∞–∑.

```python
train_ds = tf.keras.preprocessing.image_dataset_from_directory(
    data_dir, validation_split=0.2, subset="training", seed=123,
    image_size=(img_height, img_width), batch_size=batch_size,
)
```
- –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –≤—ã–¥–µ–ª—è—è 80% –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ (`subset="training"`).

```python
val_ds = tf.keras.preprocessing.image_dataset_from_directory(
    data_dir, validation_split=0.2, subset="validation", seed=123,
    image_size=(img_height, img_width), batch_size=batch_size,
)
```
- –í—ã–¥–µ–ª—è–µ–º 20% –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏.

---

## **5. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –ø–æ–¥–∞—á–µ–π –≤ –º–æ–¥–µ–ª—å**
```python
normalization_layer = tf.keras.layers.Rescaling(1.0 / 255)
```
- –ü—Ä–∏–≤–æ–¥–∏–º –∑–Ω–∞—á–µ–Ω–∏—è –ø–∏–∫—Å–µ–ª–µ–π –∫ –¥–∏–∞–ø–∞–∑–æ–Ω—É `[0,1]` (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ `[0, 255]`).

```python
train_ds = train_ds.map(lambda x, y: (normalization_layer(x), y))
val_ds = val_ds.map(lambda x, y: (normalization_layer(x), y))
```
- –ü—Ä–∏–º–µ–Ω—è–µ–º –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é.

```python
AUTOTUNE = tf.data.AUTOTUNE
train_ds = train_ds.cache().shuffle(1000).prefetch(buffer_size=AUTOTUNE)
val_ds = val_ds.cache().prefetch(buffer_size=AUTOTUNE)
```
- –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ–º –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –æ–±—É—á–µ–Ω–∏—è.

---

## **6. –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ CNN**
```python
model = tf.keras.Sequential([
    tf.keras.layers.Conv2D(32, (3, 3), activation='relu', input_shape=(img_height, img_width, 3)),
    tf.keras.layers.MaxPooling2D(),
    tf.keras.layers.Conv2D(64, (3, 3), activation='relu'),
    tf.keras.layers.MaxPooling2D(),
    tf.keras.layers.Conv2D(128, (3, 3), activation='relu'),
    tf.keras.layers.MaxPooling2D(),
    tf.keras.layers.Flatten(),
    tf.keras.layers.Dense(128, activation='relu'),
    tf.keras.layers.Dense(len(class_names), activation='softmax'),
])
```
- –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞–µ–º —Å–ª–æ–∏ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏.

---

## **7. –ö–æ–º–ø–∏–ª—è—Ü–∏—è –∏ –æ–±—É—á–µ–Ω–∏–µ**
```python
model.compile(optimizer='adam', loss='sparse_categorical_crossentropy', metrics=['accuracy'])
history = model.fit(train_ds, validation_data=val_ds, epochs=10)
```
- –ö–æ–º–ø–∏–ª–∏—Ä—É–µ–º –∏ –æ–±—É—á–∞–µ–º –º–æ–¥–µ–ª—å.

---

## **8. –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏**
```python
y_true = []
y_pred = []

for images, labels in val_ds:
    preds = model.predict(images)
    y_true.extend(labels.numpy())
    y_pred.extend(np.argmax(preds, axis=1))
```
- –ü–æ–ª—É—á–∞–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–∏.

```python
conf_mat = confusion_matrix(y_true, y_pred)
sns.heatmap(conf_mat, annot=True, fmt="d", cmap="Blues", xticklabels=class_names, yticklabels=class_names)
plt.show()
```
- –°—Ç—Ä–æ–∏–º –º–∞—Ç—Ä–∏—Ü—É –æ—à–∏–±–æ–∫.

```python
print(classification_report(y_true, y_pred, target_names=class_names))
```
- –í—ã–≤–æ–¥–∏–º –æ—Ç—á–µ—Ç.

### **–†–∞–∑–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ `tf.keras.preprocessing.image_dataset_from_directory()`**

–§—É–Ω–∫—Ü–∏—è `tf.keras.preprocessing.image_dataset_from_directory()` –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–¥–µ–ª—è–µ—Ç –∏—Ö –Ω–∞ –±–∞—Ç—á–∏ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –Ω–µ–π—Ä–æ—Å–µ—Ç–∏.  

#### **–ü–æ–ª–Ω—ã–π –≤—ã–∑–æ–≤ –≤ –∫–æ–¥–µ:**
```python
train_ds = tf.keras.preprocessing.image_dataset_from_directory(
    data_dir,
    validation_split=0.2,
    subset="training",
    seed=123,
    image_size=(img_height, img_width),
    batch_size=batch_size,
)
```
üîç –†–∞–∑–±–µ—Ä–µ–º **–∫–∞–∂–¥—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä**:

---

### **1. `data_dir`**
- **–¢–∏–ø:** `str` –∏–ª–∏ `pathlib.Path`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –≤ –∫–æ–¥–µ:** `data_dir`
- **–û–ø–∏—Å–∞–Ω–∏–µ:**  
  –£–∫–∞–∑—ã–≤–∞–µ—Ç –ø—É—Ç—å –∫ –ø–∞–ø–∫–µ, —Å–æ–¥–µ—Ä–∂–∞—â–µ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ –ø–æ–¥–ø–∞–ø–∫–∞–º.  
  - –ö–∞–∂–¥–∞—è –ø–æ–¥–ø–∞–ø–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–º—É –∫–ª–∞—Å—Å—É.
  - TensorFlow –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–ª–∞—Å—Å—ã –ø–æ –∏–º–µ–Ω–∞–º –ø–∞–ø–æ–∫.

üìå **–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö:**
```
data_dir/
‚îÇ‚îÄ‚îÄ Hematogenic_type/ (–∫–∞—Ä–∏–µ –≥–ª–∞–∑–∞)
‚îÇ   ‚îú‚îÄ‚îÄ img_1.jpg
‚îÇ   ‚îú‚îÄ‚îÄ img_2.jpg
‚îÇ‚îÄ‚îÄ Lymphoid_type/ (–≥–æ–ª—É–±—ã–µ, —Å–µ—Ä—ã–µ –≥–ª–∞–∑–∞)
‚îÇ   ‚îú‚îÄ‚îÄ img_3.jpg
‚îÇ   ‚îú‚îÄ‚îÄ img_4.jpg
‚îÇ‚îÄ‚îÄ Mixed_type/ (–∑–µ–ª—ë–Ω—ã–µ, –∂—ë–ª—Ç—ã–µ –≥–ª–∞–∑–∞)
‚îÇ   ‚îú‚îÄ‚îÄ img_5.jpg
‚îÇ   ‚îú‚îÄ‚îÄ img_6.jpg
```
**TensorFlow –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç –∫–ª–∞—Å—Å—ã:**  
```python
class_names = train_ds.class_names
print(class_names) 
# ['Hematogenic_type', 'Lymphoid_type', 'Mixed_type']
```

---

### **2. `validation_split=0.2`**
- **–¢–∏–ø:** `float`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –≤ –∫–æ–¥–µ:** `0.2`
- **–û–ø–∏—Å–∞–Ω–∏–µ:**  
  –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫–∞—è **–¥–æ–ª—è –¥–∞–Ω–Ω—ã—Ö** –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (20% = 0.2).
  - 80% –¥–∞–Ω–Ω—ã—Ö (`subset="training"`) –ø–æ–π–¥—É—Ç –≤ `train_ds`.
  - 20% –¥–∞–Ω–Ω—ã—Ö (`subset="validation"`) –ø–æ–π–¥—É—Ç –≤ `val_ds`.

---

### **3. `subset="training"`**
- **–¢–∏–ø:** `str`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –≤ –∫–æ–¥–µ:** `"training"`
- **–î–æ–ø—É—Å—Ç–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:** `"training"` –∏–ª–∏ `"validation"`
- **–û–ø–∏—Å–∞–Ω–∏–µ:**  
  –£–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫—É—é —á–∞—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö (–æ–±—É—á–∞—é—â—É—é –∏–ª–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—É—é) –∑–∞–≥—Ä—É–∂–∞—Ç—å.  
  - `subset="training"` ‚Üí –ó–∞–≥—Ä—É–∂–∞–µ—Ç **80%** –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–¥–ª—è –æ–±—É—á–µ–Ω–∏—è).
  - `subset="validation"` ‚Üí –ó–∞–≥—Ä—É–∂–∞–µ—Ç **20%** –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏).

üìå **–í–∞–∂–Ω–æ!**  
- –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º `validation_split`, –Ω—É–∂–Ω–æ **—É–∫–∞–∑—ã–≤–∞—Ç—å —ç—Ç–æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä** (–∏–Ω–∞—á–µ –æ—à–∏–±–∫–∞).  
- –ó–Ω–∞—á–µ–Ω–∏—è `"training"` –∏ `"validation"` –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å **–æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏** –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ `train_ds` –∏ `val_ds`.

---

### **4. `seed=123`**
- **–¢–∏–ø:** `int`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –≤ –∫–æ–¥–µ:** `123`
- **–û–ø–∏—Å–∞–Ω–∏–µ:**  
  **–§–∏–∫—Å–∏—Ä—É–µ—Ç —Å–ª—É—á–∞–π–Ω–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ** –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ/–≤–∞–ª–∏–¥–∞—Ü–∏—é.  
  - –ï—Å–ª–∏ **–Ω–µ —É–∫–∞–∑–∞—Ç—å `seed`**, —Ä–∞–∑–±–∏–µ–Ω–∏–µ –±—É–¥–µ—Ç —Ä–∞–∑–Ω—ã–º –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ.
  - –ü—Ä–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–º `seed=123` –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç **—Ä–∞–∑–±–∏–≤–∞—Ç—å—Å—è –æ–¥–∏–Ω–∞–∫–æ–≤–æ** –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ.

üìå **–ó–∞—á–µ–º –Ω—É–∂–µ–Ω `seed`?**  
- –î–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (—á—Ç–æ–±—ã –æ–±—É—á–µ–Ω–∏–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ–≥–¥–∞ –∏–º–µ–ª–∏ –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è).
- –û—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω–æ –ø—Ä–∏ **—Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ –º–æ–¥–µ–ª–µ–π**.

---

### **5. `image_size=(img_height, img_width)`**
- **–¢–∏–ø:** `tuple` –∏–∑ –¥–≤—É—Ö `int`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –≤ –∫–æ–¥–µ:** `(180, 180)`
- **–û–ø–∏—Å–∞–Ω–∏–µ:**  
  **–ü—Ä–∏–≤–æ–¥–∏—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É —Ä–∞–∑–º–µ—Ä—É** `(180, 180)`, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∏—Ö —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–º–∏ —Å –º–æ–¥–µ–ª—å—é.
  - –ï—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–∞–∑–Ω—ã–µ –ø–æ —Ä–∞–∑–º–µ—Ä—É, –∏—Ö **–º–∞—Å—à—Ç–∞–±–∏—Ä—É—é—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**.
  - –í—Ö–æ–¥–Ω—ã–µ —Å–ª–æ–∏ CNN —Ç—Ä–µ–±—É—é—Ç, —á—Ç–æ–±—ã –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –±—ã–ª–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏.

üìå **–ü—Ä–∏–º–µ—Ä:**
- –ò—Å—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: `300x400` ‚Üí –ò–∑–º–µ–Ω–∏—Ç—Å—è –Ω–∞ `180x180`
- –ò—Å—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: `500x600` ‚Üí –ò–∑–º–µ–Ω–∏—Ç—Å—è –Ω–∞ `180x180`

---

### **6. `batch_size=batch_size`**
- **–¢–∏–ø:** `int`
- **–ó–Ω–∞—á–µ–Ω–∏–µ –≤ –∫–æ–¥–µ:** `32`
- **–û–ø–∏—Å–∞–Ω–∏–µ:**  
  –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —Å–∫–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π **–ø–æ–¥–∞–µ—Ç—Å—è –≤ –º–æ–¥–µ–ª—å –∑–∞ –æ–¥–∏–Ω —à–∞–≥ –æ–±—É—á–µ–Ω–∏—è**.  
  - **–ë–æ–ª—å—à–∏–µ –±–∞—Ç—á–∏** (`batch_size=64, 128`) —É—Å–∫–æ—Ä—è—é—Ç –æ–±—É—á–µ–Ω–∏–µ, –Ω–æ —Ç—Ä–µ–±—É—é—Ç –±–æ–ª—å—à–µ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏.
  - **–ú–∞–ª–µ–Ω—å–∫–∏–µ –±–∞—Ç—á–∏** (`batch_size=16, 32`) —Ç—Ä–µ–±—É—é—Ç –º–µ–Ω—å—à–µ –ø–∞–º—è—Ç–∏, –Ω–æ –æ–±—É—á–µ–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–Ω–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–º.

üìå **–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã –±–∞—Ç—á–µ–π (–µ—Å–ª–∏ –≤—Å–µ–≥–æ 1000 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)**:
- `batch_size=32` ‚Üí **32 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞ —à–∞–≥** (‚âà32 —à–∞–≥–∞ –∑–∞ —ç–ø–æ—Ö—É)
- `batch_size=64` ‚Üí **64 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞ —à–∞–≥** (‚âà16 —à–∞–≥–æ–≤ –∑–∞ —ç–ø–æ—Ö—É)

---

## **‚ö° –ò—Ç–æ–≥**
–§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –¥–µ–ª–∏—Ç –∏—Ö –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç –∏ —Ä–∞–∑–±–∏–≤–∞–µ—Ç –Ω–∞ –±–∞—Ç—á–∏.

üìå **–ö–∞–∫ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –∫–æ–¥–µ?**
```python
train_ds = tf.keras.preprocessing.image_dataset_from_directory(
    data_dir,          # –ü–∞–ø–∫–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏, —Ä–∞–∑–±–∏—Ç—ã–º–∏ –ø–æ –∫–ª–∞—Å—Å–∞–º
    validation_split=0.2,  # 20% –¥–∞–Ω–Ω—ã—Ö —É—Ö–æ–¥–∏—Ç –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—é
    subset="training", # –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–æ–ª—å–∫–æ –æ–±—É—á–∞—é—â—É—é —á–∞—Å—Ç—å (80%)
    seed=123,          # –§–∏–∫—Å–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏
    image_size=(180, 180), # –í—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–∏–≤–æ–¥—è—Ç—Å—è –∫ 180x180 –ø–∏–∫—Å–µ–ª–µ–π
    batch_size=32      # –û–±—É—á–∞–µ–º –º–æ–¥–µ–ª—å –Ω–∞ –±–∞—Ç—á–∞—Ö –ø–æ 32 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
)
```

‚ö° **–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ, –∑–∞–≥—Ä—É–∂–∞–µ–º –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
```python
val_ds = tf.keras.preprocessing.image_dataset_from_directory(
    data_dir,          # –¢–∞ –∂–µ –ø–∞–ø–∫–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
    validation_split=0.2,  # –†–∞–∑–±–∏–≤–∞–µ–º —Ç–∞–∫ –∂–µ
    subset="validation", # –ó–∞–≥—Ä—É–∂–∞–µ–º –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (20%)
    seed=123,          # –¢–æ –∂–µ –∑–Ω–∞—á–µ–Ω–∏–µ `seed`, —á—Ç–æ–±—ã —Ä–∞–∑–±–∏–µ–Ω–∏–µ –±—ã–ª–æ –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–º
    image_size=(180, 180), # –í—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –±—É–¥—É—Ç 180x180 –ø–∏–∫—Å–µ–ª–µ–π
    batch_size=32      # –ë–∞—Ç—á –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ç–æ–∂–µ 32
)
```

üí° **–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º,**
- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ –ø–∞–ø–æ–∫ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–∞—Ä–∫–∏—Ä—É—é—Ç—Å—è –ø–æ –∫–ª–∞—Å—Å–∞–º.
- –î–µ–ª—è—Ç—Å—è –Ω–∞ **80% (–æ–±—É—á–µ–Ω–∏–µ) –∏ 20% (–≤–∞–ª–∏–¥–∞—Ü–∏—è)**.
- –ú–∞—Å—à—Ç–∞–±–∏—Ä—É—é—Ç—Å—è –¥–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ **180x180**.
- –†–∞–∑–±–∏–≤–∞—é—Ç—Å—è –Ω–∞ **–±–∞—Ç—á–∏ –ø–æ 32** –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.

### **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –ø–æ–¥–∞—á–µ–π –≤ –º–æ–¥–µ–ª—å**  
–ü–µ—Ä–µ–¥ —Ç–µ–º –∫–∞–∫ –æ–±—É—á–∞—Ç—å –Ω–µ–π—Ä–æ—Å–µ—Ç—å, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ. –≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –º–æ–¥–µ–ª–∏ —Ä–∞–±–æ—Ç–∞—Ç—å –±—ã—Å—Ç—Ä–µ–µ, —Ç–æ—á–Ω–µ–µ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ. –†–∞–∑–±–µ—Ä–µ–º **–∑–∞—á–µ–º** –∏ **–∫–∞–∫** –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –æ—Å–Ω–æ–≤–Ω—ã–µ —à–∞–≥–∏.

---

## **1. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (`Rescaling`)**  
üìå **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ—Ç –∫–æ–¥?**
```python
normalization_layer = tf.keras.layers.Rescaling(1.0 / 255)
```
**üîπ –ü—Ä–æ–±–ª–µ–º–∞:**  
- –í –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö –ø–∏–∫—Å–µ–ª–∏ –∏–º–µ—é—Ç –∑–Ω–∞—á–µ–Ω–∏—è –æ—Ç `0` –¥–æ `255` (8-–±–∏—Ç–Ω—ã–π —Ü–≤–µ—Ç).  
- –≠—Ç–æ **—Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ —á–∏—Å–ª–∞** –¥–ª—è –Ω–µ–π—Ä–æ—Å–µ—Ç–∏, –∏ –æ–Ω–∞ —Ö—É–∂–µ –æ–±—É—á–∞–µ—Ç—Å—è.  

**üîπ –†–µ—à–µ–Ω–∏–µ:**  
- –§—É–Ω–∫—Ü–∏—è `Rescaling(1.0 / 255)` –¥–µ–ª–∏—Ç –≤—Å–µ –ø–∏–∫—Å–µ–ª–∏ –Ω–∞ `255`, –ø–µ—Ä–µ–≤–æ–¥—è –∏—Ö –≤ –¥–∏–∞–ø–∞–∑–æ–Ω `[0,1]`.  
- –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –æ–±—É—á–µ–Ω–∏–µ **–±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–º** –∏ —É—Å–∫–æ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç—É —Å–µ—Ç–∏.

üìå **–ü—Ä–∏–º–µ—Ä –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è:**
| –ò—Å—Ö–æ–¥–Ω—ã–π –ø–∏–∫—Å–µ–ª—å | –ü–æ—Å–ª–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ |
|------------------|--------------------|
| 0 (—á—ë—Ä–Ω—ã–π)       | 0.0                |
| 128 (—Å–µ—Ä—ã–π)      | 0.5                |
| 255 (–±–µ–ª—ã–π)      | 1.0                |

üëâ **–ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?**  
- –£–ª—É—á—à–∞–µ—Ç **—Å—Ö–æ–¥–∏–º–æ—Å—Ç—å** –º–æ–¥–µ–ª–∏ (–±—ã—Å—Ç—Ä–µ–µ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –æ—à–∏–±–∫–∞).  
- –î–µ–ª–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è **–±–æ–ª–µ–µ —É–¥–æ–±–Ω—ã–º–∏** –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –≤ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏.  

---

## **2. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –∫ –¥–∞—Ç–∞—Å–µ—Ç—É**
üìå **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ—Ç –∫–æ–¥?**
```python
train_ds = train_ds.map(lambda x, y: (normalization_layer(x), y))
val_ds = val_ds.map(lambda x, y: (normalization_layer(x), y))
```
**üîπ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?**  
- `train_ds.map(...)` –ø—Ä–∏–º–µ–Ω—è–µ—Ç **—Ñ—É–Ω–∫—Ü–∏—é –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏** –∫–æ –≤—Å–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º –≤ –æ–±—É—á–∞—é—â–µ–º –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö.  
- –¢–µ–ø–µ—Ä—å –º–æ–¥–µ–ª—å –±—É–¥–µ—Ç –ø–æ–ª—É—á–∞—Ç—å **–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ** –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.

üëâ **–ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?**  
- –£–ø—Ä–æ—â–∞–µ—Ç –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏.  
- –î–∞–Ω–Ω—ã–µ –≤ **—Ä–∞–∑–Ω—ã—Ö –±–∞—Ç—á–∞—Ö** –±—É–¥—É—Ç –≤ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ `[0,1]`, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –æ–±—É—á–µ–Ω–∏–µ **–±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–º**.

---

## **3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö**
üìå **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ—Ç –∫–æ–¥?**
```python
AUTOTUNE = tf.data.AUTOTUNE
train_ds = train_ds.cache().shuffle(1000).prefetch(buffer_size=AUTOTUNE)
val_ds = val_ds.cache().prefetch(buffer_size=AUTOTUNE)
```
### **üîπ –†–∞–∑–±–µ—Ä–µ–º –∫–∞–∂–¥—É—é –æ–ø–µ—Ä–∞—Ü–∏—é:**
### 1Ô∏è‚É£ `cache()` ‚Äì –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –ø–∞–º—è—Ç–∏  
```python
train_ds = train_ds.cache()
```
- **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç?**  
  - –•—Ä–∞–Ω–∏—Ç **–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ** –¥–∞–Ω–Ω—ã–µ –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ (RAM), —á—Ç–æ–±—ã –∏—Ö –Ω–µ –∑–∞–≥—Ä—É–∂–∞—Ç—å –∑–∞–Ω–æ–≤–æ —Å –¥–∏—Å–∫–∞.  
  - –£—Å–∫–æ—Ä—è–µ—Ç –æ–±—É—á–µ–Ω–∏–µ, –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö **–º–Ω–æ–≥–æ**.

- **–ö–æ–≥–¥–∞ –ø–æ–ª–µ–∑–Ω–æ?**  
  - –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ **—É–º–µ—â–∞—é—Ç—Å—è** –≤ –ø–∞–º—è—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, 1000-5000 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π).  

---

### 2Ô∏è‚É£ `shuffle(1000)` ‚Äì –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö  
```python
train_ds = train_ds.shuffle(1000)
```
- **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç?**  
  - **–ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ—Ç** –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, —á—Ç–æ–±—ã –º–æ–¥–µ–ª—å **–Ω–µ –∑–∞–ø–æ–º–∏–Ω–∞–ª–∞ –ø–æ—Ä—è–¥–æ–∫**.  
  - –ï—Å–ª–∏ —ç—Ç–æ–≥–æ –Ω–µ –¥–µ–ª–∞—Ç—å, –º–æ–¥–µ–ª—å –º–æ–∂–µ—Ç **–∑–∞–ø–æ–º–Ω–∏—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å** –∏ —Ö—É–∂–µ –æ–±–æ–±—â–∞—Ç—å –¥–∞–Ω–Ω—ã–µ.  

- **–ü–æ—á–µ–º—É `1000`?**  
  - –≠—Ç–æ —á–∏—Å–ª–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –ø–µ—Ä–µ–º–µ—à–∏–≤–∞—é—Ç—Å—è —Å—Ä–∞–∑—É 1000 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.  
  - –ß–µ–º –±–æ–ª—å—à–µ –∑–Ω–∞—á–µ–Ω–∏–µ ‚Äì —Ç–µ–º –ª—É—á—à–µ –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏–µ, –Ω–æ –±–æ–ª—å—à–µ —Ä–∞—Å—Ö–æ–¥—É–µ—Ç—Å—è –ø–∞–º—è—Ç–∏.

---

### 3Ô∏è‚É£ `prefetch(buffer_size=AUTOTUNE)` ‚Äì –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ  
```python
train_ds = train_ds.prefetch(buffer_size=AUTOTUNE)
val_ds = val_ds.prefetch(buffer_size=AUTOTUNE)
```
- **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç?**  
  - **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ** –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π –±–∞—Ç—á –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –ø–æ–∫–∞ –º–æ–¥–µ–ª—å –æ–±—É—á–∞–µ—Ç—Å—è –Ω–∞ —Ç–µ–∫—É—â–µ–º.  
  - –ü–æ–∑–≤–æ–ª—è–µ—Ç **—É—Å–∫–æ—Ä–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ** –∑–∞ —Å—á–µ—Ç **–ª—É—á—à–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞/GPU**.  

- **–ß—Ç–æ –∑–Ω–∞—á–∏—Ç `AUTOTUNE`?**  
  - TensorFlow **—Å–∞–º –≤—ã–±–∏—Ä–∞–µ—Ç** –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∏.  
  - **–ù–µ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å!**

üëâ **–ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?**  
- –£–º–µ–Ω—å—à–∞–µ—Ç **–≤—Ä–µ–º—è –ø—Ä–æ—Å—Ç–æ—è** –º–æ–¥–µ–ª–∏ (GPU –Ω–µ –∂–¥–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö).  
- –£–ª—É—á—à–∞–µ—Ç **–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è**.  

---

## **üõ† –ò—Ç–æ–≥: –∑–∞—á–µ–º –Ω—É–∂–Ω–∞ –≤—Å—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞?**
| –®–∞–≥ | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç? | –ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ? |
|-----|------------|--------------|
| **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è (`Rescaling`)** | –ü—Ä–∏–≤–æ–¥–∏—Ç –ø–∏–∫—Å–µ–ª–∏ –∫ –¥–∏–∞–ø–∞–∑–æ–Ω—É `[0,1]`. | –î–µ–ª–∞–µ—Ç –æ–±—É—á–µ–Ω–∏–µ —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ –∏ –±—ã—Å—Ç—Ä–µ–µ. |
| **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ (`map()`)** | –ù–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ. | –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –º–æ–¥–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. |
| **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (`cache()`)** | –•—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –≤ –ø–∞–º—è—Ç–∏. | –£—Å–∫–æ—Ä—è–µ—Ç –æ–±—É—á–µ–Ω–∏–µ. |
| **–ü–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏–µ (`shuffle()`)** | –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥ –æ–±—É—á–µ–Ω–∏–µ–º. | –ü–æ–º–æ–≥–∞–µ—Ç –º–æ–¥–µ–ª–∏ –ª—É—á—à–µ –æ–±–æ–±—â–∞—Ç—å –¥–∞–Ω–Ω—ã–µ. |
| **–ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ (`prefetch()`)** | –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ–Ω–µ. | –°–Ω–∏–∂–∞–µ—Ç –∑–∞–¥–µ—Ä–∂–∫–∏, —É—Å–∫–æ—Ä—è–µ—Ç –æ–±—É—á–µ–Ω–∏–µ. |

## **–†–∞–∑–±–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Å–≤–µ—Ä—Ç–æ—á–Ω–æ–π –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ (CNN)**  

–í –∫–æ–¥–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ **—Å–≤–µ—Ä—Ç–æ—á–Ω–∞—è –Ω–µ–π—Ä–æ—Å–µ—Ç—å (Convolutional Neural Network, CNN)** —Å –ø–æ–º–æ—â—å—é **Sequential API** –≤ Keras. –î–∞–≤–∞–π—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞–∑–±–µ—Ä–µ–º **–∫–∞–∂–¥—ã–π —Å–ª–æ–π**, –∑–∞—á–µ–º –æ–Ω –Ω—É–∂–µ–Ω –∏ –∫–∞–∫ –≤–ª–∏—è–µ—Ç –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.  

---

## **üìå 1. –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏**
```python
model = tf.keras.Sequential([
```
üìå **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç?**  
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç **–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—É—é (Sequential)** –º–æ–¥–µ–ª—å, –≤ –∫–æ—Ç–æ—Ä–æ–π —Å–ª–æ–∏ –∏–¥—É—Ç **–¥—Ä—É–≥ –∑–∞ –¥—Ä—É–≥–æ–º**.  
- –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç **–ø—Ä–æ—Ö–æ–¥–∏—Ç—å —á–µ—Ä–µ–∑ –∫–∞–∂–¥—ã–π —Å–ª–æ–π** –ø–æ –ø–æ—Ä—è–¥–∫—É.  

**üîπ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã**:  
- –í–º–µ—Å—Ç–æ `Sequential` –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Functional API`, –µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è **—Å–ª–æ–∂–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** (—Ä–∞–∑–≤–µ—Ç–≤–ª–µ–Ω–∏—è, –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ —Å–ª–æ–∏ –∏ —Ç.–¥.).  

---

## **üìå 2. –ü–µ—Ä–≤—ã–π —Å–≤–µ—Ä—Ç–æ—á–Ω—ã–π —Å–ª–æ–π (`Conv2D`)**
```python
tf.keras.layers.Conv2D(32, (3, 3), activation='relu', input_shape=(img_height, img_width, 3)),
```
üìå **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç?**  
- –≠—Ç–æ **—Å–≤–µ—Ä—Ç–æ—á–Ω—ã–π —Å–ª–æ–π** (`Conv2D`), –∫–æ—Ç–æ—Ä—ã–π –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –≤—ã–¥–µ–ª—è—è **–∫–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏** (–∫—Ä–∞—è, —Ç–µ–∫—Å—Ç—É—Ä—ã –∏ —Ç. –¥.).  
- `32` ‚Äì **–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤** (–Ω–µ–π—Ä–æ–Ω–æ–≤), –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é—â–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ.  
- `(3, 3)` ‚Äì **—Ä–∞–∑–º–µ—Ä —è–¥—Ä–∞ (—Ñ–∏–ª—å—Ç—Ä–∞)**, –∫–æ—Ç–æ—Ä—ã–π —Å–∫–æ–ª—å–∑–∏—Ç –ø–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –µ–≥–æ —É—á–∞—Å—Ç–∫–∏.  
- `activation='relu'` ‚Äì **—Ñ—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏** ReLU (–æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è).  
- `input_shape=(img_height, img_width, 3)` ‚Äì **—Ä–∞–∑–º–µ—Ä –≤—Ö–æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è** (–≤—ã—Å–æ—Ç–∞, —à–∏—Ä–∏–Ω–∞, 3 –∫–∞–Ω–∞–ª–∞ –¥–ª—è RGB).  

üìå **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–≤–µ—Ä—Ç–∫–∞?**  
- –Ø–¥—Ä–æ —Ä–∞–∑–º–µ—Ä–æ–º `3x3` –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è –ø–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é –∏ –≤—ã—á–∏—Å–ª—è–µ—Ç **–Ω–æ–≤—ã–µ –ø–∏–∫—Å–µ–ª–∏** –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ö–æ–¥–Ω—ã—Ö.  
- –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –Ω–∞ –≤—Ö–æ–¥–µ `180x180x3`, —Ç–æ –ø–æ—Å–ª–µ —Å–≤–µ—Ä—Ç–∫–∏ —Ä–∞–∑–º–µ—Ä –±—É–¥–µ—Ç `178x178x32` (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫).  

üìå **–ü–æ—á–µ–º—É `ReLU`?**  
- **–û–±–Ω—É–ª—è–µ—Ç** –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –æ—Å—Ç–∞–≤–ª—è—è —Ç–æ–ª—å–∫–æ **–∑–Ω–∞—á–∏–º—ã–µ** –ø—Ä–∏–∑–Ω–∞–∫–∏.  
- –£—Å–∫–æ—Ä—è–µ—Ç –æ–±—É—á–µ–Ω–∏–µ –∏ **–∏–∑–±–µ–≥–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã –∏—Å—á–µ–∑–∞—é—â–µ–≥–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞**.  

---

## **üìå 3. –ü–µ—Ä–≤—ã–π —Å–ª–æ–π –ø–æ–¥–≤—ã–±–æ—Ä–∫–∏ (`MaxPooling2D`)**
```python
tf.keras.layers.MaxPooling2D(),
```
üìå **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç?**  
- **–£–º–µ–Ω—å—à–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è**, —Å–æ—Ö—Ä–∞–Ω—è—è **—Å–∞–º—ã–µ –≤–∞–∂–Ω—ã–µ** –ø—Ä–∏–∑–Ω–∞–∫–∏.  
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç **–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ (max pooling)** ‚Äì –±–µ—Ä—ë—Ç **–Ω–∞–∏–±–æ–ª—å—à–µ–µ** –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —Å–æ—Å–µ–¥–Ω–∏—Ö –ø–∏–∫—Å–µ–ª–µ–π.  
- –û–±—ã—á–Ω—ã–π —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞ **(2,2)** ‚Äì –¥–µ–ª–∏—Ç –∫–∞—Ä—Ç–∏–Ω–∫—É **–Ω–∞ 4 —á–∞—Å—Ç–∏ –∏ –±–µ—Ä–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –∫–∞–∂–¥–æ–π**.  

üìå **–ü—Ä–∏–º–µ—Ä (–º–∞—Ç—Ä–∏—Ü–∞ 2x2, `MaxPooling` 2x2):**
```
[ 5, 2 ]    ->  5
[ 1, 8 ]        8
```
üëâ –ü–æ—Å–ª–µ `MaxPooling`, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è **–≤ 2 —Ä–∞–∑–∞** –ø–æ —à–∏—Ä–∏–Ω–µ –∏ –≤—ã—Å–æ—Ç–µ.  

üìå **–ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?**  
- **–£–±–∏—Ä–∞–µ—Ç —à—É–º**, –æ—Å—Ç–∞–≤–ª—è—è **–≥–ª–∞–≤–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏**.  
- **–£–º–µ–Ω—å—à–∞–µ—Ç –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã** ‚Äì –º–æ–¥–µ–ª—å –æ–±—É—á–∞–µ—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ.  

---

## **üìå 4. –í—Ç–æ—Ä–æ–π —Å–≤–µ—Ä—Ç–æ—á–Ω—ã–π —Å–ª–æ–π (`Conv2D`)**
```python
tf.keras.layers.Conv2D(64, (3, 3), activation='relu'),
tf.keras.layers.MaxPooling2D(),
```
üìå **–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å?**  
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤ —É–≤–µ–ª–∏—á–∏–ª–æ—Å—å —Å `32` ‚Üí `64`.  
- –£—Å–ª–æ–∂–Ω—è–µ—Ç –ø–æ–∏—Å–∫ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ ‚Äì —Ç–µ–ø–µ—Ä—å —Å–µ—Ç—å **—Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã**.  
- –ü–æ—Å–ª–µ `MaxPooling2D()` —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è **–µ—â—ë —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è –≤ 2 —Ä–∞–∑–∞**.  

üìå **–ó–∞—á–µ–º —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã?**  
- **–ü–µ—Ä–≤—ã–π —Å–ª–æ–π** –ª–æ–≤–∏—Ç **–ø—Ä–æ—Å—Ç—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏** (–ª–∏–Ω–∏–∏, –∫–æ–Ω—Ç—É—Ä—ã).  
- **–í—Ç–æ—Ä–æ–π —Å–ª–æ–π** –Ω–∞—Ö–æ–¥–∏—Ç **—Å–ª–æ–∂–Ω—ã–µ —Ñ–æ—Ä–º—ã** (–≥–ª–∞–∑–∞, –Ω–æ—Å, —Ç–µ–∫—Å—Ç—É—Ä—ã).  

---

## **üìå 5. –¢—Ä–µ—Ç–∏–π —Å–≤–µ—Ä—Ç–æ—á–Ω—ã–π —Å–ª–æ–π (`Conv2D`)**
```python
tf.keras.layers.Conv2D(128, (3, 3), activation='relu'),
tf.keras.layers.MaxPooling2D(),
```
üìå **–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å?**  
- –¢–µ–ø–µ—Ä—å **128 —Ñ–∏–ª—å—Ç—Ä–æ–≤** ‚Äì –µ—â–µ –±–æ–ª—å—à–µ –Ω–µ–π—Ä–æ–Ω–æ–≤ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ.  
- –°–µ—Ç—å —Ç–µ–ø–µ—Ä—å **–≤–∏–¥–∏—Ç –æ–±—ä–µ–∫—Ç—ã —Ü–µ–ª–∏–∫–æ–º** (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ñ–æ—Ä–º—É –≥–ª–∞–∑–∞).  

üìå **–ó–∞—á–µ–º 3 —Å–≤–µ—Ä—Ç–æ—á–Ω—ã—Ö —Å–ª–æ—è?**  
- **1 —Å–ª–æ–π** ‚Äì –±–∞–∑–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (–≥—Ä–∞–Ω–∏—Ü—ã, —Ç–æ—á–∫–∏).  
- **2 —Å–ª–æ–π** ‚Äì –¥–µ—Ç–∞–ª–∏ (–∫—Ä–∏–≤—ã–µ, —É–≥–ª—ã).  
- **3 —Å–ª–æ–π** ‚Äì —Å–ª–æ–∂–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã (—Ü–µ–ª—ã–µ –æ–±—ä–µ–∫—Ç—ã).  

---

## **üìå 6. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ –ø–ª–æ—Å–∫–∏–π –≤–µ–∫—Ç–æ—Ä (`Flatten`)**
```python
tf.keras.layers.Flatten(),
```
üìå **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç?**  
- –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç **–º–Ω–æ–≥–æ–º–µ—Ä–Ω—É—é –∫–∞—Ä—Ç—É –ø—Ä–∏–∑–Ω–∞–∫–æ–≤** –≤ **–æ–¥–Ω–æ–º–µ—Ä–Ω—ã–π –≤–µ–∫—Ç–æ—Ä**.  
- –ì–æ—Ç–æ–≤–∏—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è **–ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã—Ö —Å–ª–æ–µ–≤** (`Dense`).  

üìå **–ü—Ä–∏–º–µ—Ä:**  
–î–æ–ø—É—Å—Ç–∏–º, –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ `MaxPooling` –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞–ª–æ `22x22x128` (—à–∏—Ä–∏–Ω–∞, –≤—ã—Å–æ—Ç–∞, —Ñ–∏–ª—å—Ç—Ä—ã).  
–ü–æ—Å–ª–µ `Flatten()` —ç—Ç–æ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ **–≤–µ–∫—Ç–æ—Ä –∏–∑ 22 √ó 22 √ó 128 = 61 952 –∑–Ω–∞—á–µ–Ω–∏–π**.  

---

## **üìå 7. –ü–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–π —Å–ª–æ–π (`Dense`)**
```python
tf.keras.layers.Dense(128, activation='relu'),
```
üìå **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç?**  
- `128` ‚Äì **–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–π—Ä–æ–Ω–æ–≤** (—Å–∫—Ä—ã—Ç—ã–π —Å–ª–æ–π).  
- `activation='relu'` ‚Äì –Ω–µ–ª–∏–Ω–µ–π–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, —É—Å–∏–ª–∏–≤–∞—é—â–∞—è –ø–æ–ª–µ–∑–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏.  
- –≠—Ç–æ—Ç —Å–ª–æ–π **–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏** –∏ —É—á–∏—Ç—Å—è –¥–µ–ª–∞—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è.  

üìå **–ó–∞—á–µ–º –Ω—É–∂–µ–Ω –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–π —Å–ª–æ–π?**  
- –°–≤—è–∑—ã–≤–∞–µ—Ç **–≤—Å–µ –ø—Ä–∏–∑–Ω–∞–∫–∏**, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑.  
- –†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ **"–º–æ–∑–≥", –ø—Ä–∏–Ω–∏–º–∞—é—â–∏–π —Ä–µ—à–µ–Ω–∏–µ**.  

---

## **üìå 8. –í—ã—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π (`Dense`)**
```python
tf.keras.layers.Dense(len(class_names), activation='softmax'),
```
üìå **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç?**  
- `len(class_names)` ‚Äì –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã—Ö–æ–¥–Ω—ã—Ö **–∫–ª–∞—Å—Å–æ–≤** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `3`, –µ—Å–ª–∏ `Hematogenic`, `Lymphoid`, `Mixed`).  
- `activation='softmax'` ‚Äì –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –∑–Ω–∞—á–µ–Ω–∏—è –≤ **–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏**, –≥–¥–µ —Å—É–º–º–∞ = `1.0`.  

üìå **–ü—Ä–∏–º–µ—Ä –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è (`softmax`):**
| –ö–ª–∞—Å—Å  | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å |
|--------|------------|
| Hematogenic | 0.10 |
| Lymphoid | 0.80 |
| Mixed | 0.10 |

üëâ **–ù–∞–∏–±–æ–ª—å—à–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å (`0.80`) ‚Äì –∑–Ω–∞—á–∏—Ç, —Å–µ—Ç—å —Å—á–∏—Ç–∞–µ—Ç, —á—Ç–æ —ç—Ç–æ `Lymphoid` (–≥–æ–ª—É–±—ã–µ –≥–ª–∞–∑–∞).**  

üìå **–ó–∞—á–µ–º `softmax`?**  
- –ü—Ä–µ–≤—Ä–∞—â–∞–µ—Ç —á–∏—Å–ª–∞ –≤ **–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏** (–æ—Ç `0` –¥–æ `1`).  
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏ **–¥–µ–ª–∞—Ç—å –≤—ã–±–æ—Ä –º–µ–∂–¥—É –∫–ª–∞—Å—Å–∞–º–∏**.  

---

## **üõ† –ò—Ç–æ–≥: –∑–∞—á–µ–º –Ω—É–∂–Ω—ã –≤—Å–µ —Å–ª–æ–∏?**
| –°–ª–æ–π | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç? | –ó–∞—á–µ–º? |
|------|------------|--------|
| **Conv2D(32, (3,3))** | –ù–∞—Ö–æ–¥–∏—Ç –≥—Ä–∞–Ω–∏—Ü—ã –∏ –∫–æ–Ω—Ç—É—Ä—ã. | –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –±–∞–∑–æ–≤—ã–µ —Ñ–æ—Ä–º—ã. |
| **MaxPooling2D()** | –£–º–µ–Ω—å—à–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. | –û—Å—Ç–∞–≤–ª—è–µ—Ç –≤–∞–∂–Ω–æ–µ, —É–±–∏—Ä–∞–µ—Ç —à—É–º. |
| **Conv2D(64, (3,3))** | –ò—â–µ—Ç –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ —Ç–µ–∫—Å—Ç—É—Ä—ã. | –†–∞—Å–ø–æ–∑–Ω–∞—ë—Ç —á–∞—Å—Ç–∏ –æ–±—ä–µ–∫—Ç–æ–≤. |
| **MaxPooling2D()** | –ï—â—ë —É–º–µ–Ω—å—à–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ. | –£–±–∏—Ä–∞–µ—Ç –ª–∏—à–Ω—é—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é. |
| **Conv2D(128, (3,3))** | –†–∞—Å–ø–æ–∑–Ω–∞—ë—Ç —Ü–µ–ª—ã–µ –æ–±—ä–µ–∫—Ç—ã. | –í–∏–¥–∏—Ç —Å–ª–æ–∂–Ω—ã–µ —Ñ–æ—Ä–º—ã. |
| **Flatten()** | –ü—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–∏–∑–Ω–∞–∫–∏ –≤ –≤–µ–∫—Ç–æ—Ä. | –ì–æ—Ç–æ–≤–∏—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è. |
| **Dense(128, relu)** | –í—ã–¥–µ–ª—è–µ—Ç –≥–ª–∞–≤–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏. | –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–µ—à–µ–Ω–∏–µ. |
| **Dense(num_classes, softmax)** | –ü—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –∫–ª–∞—Å—Å. | –î–µ–ª–∞–µ—Ç –∏—Ç–æ–≥–æ–≤—ã–π –≤—ã–±–æ—Ä. |

## **üìå –ö–æ–º–ø–∏–ª—è—Ü–∏—è –∏ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –≤ TensorFlow/Keras**  

–¢–µ–ø–µ—Ä—å —Ä–∞–∑–±–µ—Ä—ë–º —Å—Ç—Ä–æ–∫—É:  
```python
model.compile(optimizer='adam', loss='sparse_categorical_crossentropy', metrics=['accuracy'])
history = model.fit(train_ds, validation_data=val_ds, epochs=10)
```
–ó–¥–µ—Å—å –º—ã **–∫–æ–º–ø–∏–ª–∏—Ä—É–µ–º –∏ –æ–±—É—á–∞–µ–º** –Ω–µ–π—Ä–æ—Å–µ—Ç—å. –†–∞–∑–±–µ—Ä—ë–º **–∫–∞–∂–¥—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä** –∏ —à–∞–≥ —ç—Ç–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.  

---

## **üîπ 1. –ö–æ–º–ø–∏–ª—è—Ü–∏—è –º–æ–¥–µ–ª–∏ (`compile()`)**
```python
model.compile(optimizer='adam', loss='sparse_categorical_crossentropy', metrics=['accuracy'])
```
üìå **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç?**  
- **–ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ—Ç –º–æ–¥–µ–ª—å** –∫ –æ–±—É—á–µ–Ω–∏—é, –≤—ã–±–∏—Ä–∞—è **–æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä**, **—Ñ—É–Ω–∫—Ü–∏—é –ø–æ—Ç–µ—Ä—å** –∏ **–º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞**.  

üìå **–†–∞–∑–±–µ—Ä—ë–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- **`optimizer='adam'`** ‚Äì –∞–ª–≥–æ—Ä–∏—Ç–º, –∫–æ—Ç–æ—Ä—ã–π **–æ–±–Ω–æ–≤–ª—è–µ—Ç –≤–µ—Å–∞** –Ω–µ–π—Ä–æ–Ω–æ–≤.  
- **`loss='sparse_categorical_crossentropy'`** ‚Äì —Ñ—É–Ω–∫—Ü–∏—è –æ—à–∏–±–∫–∏ (—á–µ–º –º–µ–Ω—å—à–µ, —Ç–µ–º –ª—É—á—à–µ).  
- **`metrics=['accuracy']`** ‚Äì –∏–∑–º–µ—Ä—è–µ—Ç **—Ç–æ—á–Ω–æ—Å—Ç—å** –º–æ–¥–µ–ª–∏.  

üìå **–†–∞–∑–±–µ—Ä—ë–º –ø–æ–¥—Ä–æ–±–Ω–µ–µ!** üëá  

### **1.1. –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä (`adam`)**  
```python
optimizer='adam'
```
- **–û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä** ‚Äì —ç—Ç–æ –∞–ª–≥–æ—Ä–∏—Ç–º, –∫–æ—Ç–æ—Ä—ã–π **–∏–∑–º–µ–Ω—è–µ—Ç –≤–µ—Å–∞ –Ω–µ–π—Ä–æ–Ω–æ–≤**, —á—Ç–æ–±—ã –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫—É.  
- **Adam (Adaptive Moment Estimation)** ‚Äì —Å–∞–º—ã–π **–ø–æ–ø—É–ª—è—Ä–Ω—ã–π** –∏ **–±—ã—Å—Ç—Ä—ã–π** –º–µ—Ç–æ–¥.  

üîπ **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç Adam?**  
1. –°–ª–µ–¥–∏—Ç –∑–∞ **—Å—Ä–µ–¥–Ω–∏–º –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–º** (–∫–∞–∫ "—É—Å–∫–æ—Ä–µ–Ω–∏–µ" –≤ —Ñ–∏–∑–∏–∫–µ).  
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–±–∏—Ä–∞–µ—Ç** —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–µ—Å–∞.  
3. **–ë—ã—Å—Ç—Ä–µ–µ –Ω–∞—Ö–æ–¥–∏—Ç –º–∏–Ω–∏–º—É–º —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å**, —á–µ–º –æ–±—ã—á–Ω—ã–π `SGD`.  

üëâ **–ü–æ—á–µ–º—É Adam?**  
- –†–∞–±–æ—Ç–∞–µ—Ç **—Ö–æ—Ä–æ—à–æ –ø–æ—á—Ç–∏ –≤–æ –≤—Å–µ—Ö –∑–∞–¥–∞—á–∞—Ö**.  
- **–ù–µ —Ç—Ä–µ–±—É–µ—Ç —Ä—É—á–Ω–æ–≥–æ –ø–æ–¥–±–æ—Ä–∞** —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ–±—É—á–µ–Ω–∏—è (`learning rate`).  

---

### **1.2. –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å (`sparse_categorical_crossentropy`)**  
```python
loss='sparse_categorical_crossentropy'
```
- –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å **–∏–∑–º–µ—Ä—è–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–∏ –¥–∞–ª–µ–∫–∏ –æ—Ç –∏—Å—Ç–∏–Ω—ã**.  
- –í —ç—Ç–æ–π –∑–∞–¥–∞—á–µ —É –Ω–∞—Å **–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–ª–∞—Å—Å–æ–≤** (`Hematogenic`, `Lymphoid`, `Mixed`).  

üìå **–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ `sparse_categorical_crossentropy`?**  
- –î–∞–Ω–Ω—ã–µ —Ä–∞–∑–º–µ—á–µ–Ω—ã **—á–∏—Å–ª–æ–≤—ã–º–∏ –º–µ—Ç–∫–∞–º–∏** (`0, 1, 2`), –∞ –Ω–µ –≤ –≤–∏–¥–µ "one-hot" (–Ω–∞–ø—Ä–∏–º–µ—Ä, `[1,0,0]`).  
- –ï—Å–ª–∏ –±—ã –∫–ª–∞—Å—Å—ã –±—ã–ª–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –≤ –≤–∏–¥–µ `[1,0,0]`, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –±—ã `categorical_crossentropy`.  
- **–ö—Ä–æ—Å—Å-—ç–Ω—Ç—Ä–æ–ø–∏—è** ‚Äì —ç—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ—à–∏–±–∫–∏ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏.  

üëâ **–ö–∞–∫ –æ–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç?**  
- –û–Ω–∞ **—Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏** (–∏–∑ `softmax`) —Å **—Ä–µ–∞–ª—å–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏ –∫–ª–∞—Å—Å–æ–≤**.  
- –ß–µ–º **–±–æ–ª—å—à–µ –æ—à–∏–±–∫–∞**, —Ç–µ–º —Å–∏–ª—å–Ω–µ–µ **–Ω–µ–π—Ä–æ—Å–µ—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç —Å–≤–æ–∏ –≤–µ—Å–∞**.  

–ü—Ä–∏–º–µ—Ä:  
**–ò—Å—Ç–∏–Ω–Ω—ã–π –∫–ª–∞—Å—Å:** `1 (Lymphoid)`  
**–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–∏:** `[0.1, 0.8, 0.1]`  
- –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å –ø–æ–∫–∞–∂–µ—Ç **–º–∞–ª–µ–Ω—å–∫—É—é –æ—à–∏–±–∫—É** (–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –±–ª–∏–∑–∫–æ –∫ –∏—Å—Ç–∏–Ω–µ).  
- –ï—Å–ª–∏ –±—ã –±—ã–ª–æ `[0.8, 0.1, 0.1]`, –æ—à–∏–±–∫–∞ –±—ã–ª–∞ –±—ã **–±–æ–ª—å—à–æ–π**.  

---

### **1.3. –ú–µ—Ç—Ä–∏–∫–∞ (`accuracy`)**
```python
metrics=['accuracy']
```
- **–ú–µ—Ç—Ä–∏–∫–∞** –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç **–∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏**, –Ω–æ **–Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ**.  
- **`accuracy` (—Ç–æ—á–Ω–æ—Å—Ç—å)** ‚Äì –¥–æ–ª—è **–ø—Ä–∞–≤–∏–ª—å–Ω–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö** –ø—Ä–∏–º–µ—Ä–æ–≤.  

–ü—Ä–∏–º–µ—Ä:  
- **100 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**  
- **80 –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö**  
- **–¢–æ—á–Ω–æ—Å—Ç—å (accuracy) = 80%**  

üëâ **–ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ —Ä–∞–∑–ª–∏—á–∞—Ç—å `loss` –∏ `accuracy`?**  
- `loss` ‚Äì –∏–∑–º–µ—Ä—è–µ—Ç **–æ—à–∏–±–∫—É –º–æ–¥–µ–ª–∏** (–≤–∞–∂–Ω–æ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è).  
- `accuracy` ‚Äì —É–¥–æ–±–Ω–∞ –¥–ª—è **–æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏**.  

---

## **üîπ 2. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ (`fit()`)**  
```python
history = model.fit(train_ds, validation_data=val_ds, epochs=10)
```
üìå **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç?**  
- –ó–∞–ø—É—Å–∫–∞–µ—Ç **–ø—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è** –º–æ–¥–µ–ª–∏ –Ω–∞ `train_ds` (—Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö).  
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –Ω–∞ `val_ds` (–≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö).  
- –ü—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ **–≤—Å–µ –¥–∞–Ω–Ω—ã–µ 10 —Ä–∞–∑** (`epochs=10`).  
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –æ–±—É—á–µ–Ω–∏—è –≤ `history` (–ø–æ—Ç–æ–º –º–æ–∂–Ω–æ —Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏).  

üìå **–†–∞–∑–±–µ—Ä—ë–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**  
- **`train_ds`** ‚Äì —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –º–µ—Ç–∫–∏ –∫–ª–∞—Å—Å–æ–≤).  
- **`validation_data=val_ds`** ‚Äì –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ **–Ω–æ–≤—ã—Ö** –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö.  
- **`epochs=10`** ‚Äì **—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑** –ø—Ä–æ–π—Ç–∏ —á–µ—Ä–µ–∑ –≤–µ—Å—å –¥–∞—Ç–∞—Å–µ—Ç.  

üëâ **–ü–æ—á–µ–º—É `epochs=10`?**  
- –ï—Å–ª–∏ `epochs` **—Å–ª–∏—à–∫–æ–º –º–∞–ª–æ** ‚Äì –º–æ–¥–µ–ª—å **–Ω–µ –¥–æ—É—á–∏—Ç—Å—è** (–æ—à–∏–±–∫–∞ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –±–æ–ª—å—à–æ–π).  
- –ï—Å–ª–∏ `epochs` **—Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ** ‚Äì –º–æ–¥–µ–ª—å **–ø–µ—Ä–µ–æ–±—É—á–∏—Ç—Å—è** (–∑–∞–ø–æ–º–Ω–∏—Ç —Ç—Ä–µ–Ω. –¥–∞–Ω–Ω—ã–µ, –Ω–æ –ø–ª–æ—Ö–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –Ω–æ–≤—ã—Ö).  
- `10` —ç–ø–æ—Ö ‚Äì **–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ä—Ç**, –Ω–æ –ª—É—á—à–µ **–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ –æ—à–∏–±–∫–∏**.  

---

## **üõ† –ò—Ç–æ–≥: —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ `compile()` –∏ `fit()`?**
| –®–∞–≥ | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç? | –ó–∞—á–µ–º? |
|------|------------|--------|
| `compile()` | –ì–æ—Ç–æ–≤–∏—Ç –º–æ–¥–µ–ª—å –∫ –æ–±—É—á–µ–Ω–∏—é, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—è –∞–ª–≥–æ—Ä–∏—Ç–º—ã. | –í—ã–±–∏—Ä–∞–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä, —Ñ—É–Ω–∫—Ü–∏—é –ø–æ—Ç–µ—Ä—å, –º–µ—Ç—Ä–∏–∫–∏. |
| `optimizer='adam'` | –û–±–Ω–æ–≤–ª—è–µ—Ç –≤–µ—Å–∞ –Ω–µ–π—Ä–æ–Ω–æ–≤ –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –æ—à–∏–±–∫–∏. | –ë—ã—Å—Ç—Ä–æ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ–±—É—á–∞–µ—Ç –Ω–µ–π—Ä–æ—Å–µ—Ç—å. |
| `loss='sparse_categorical_crossentropy'` | –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–∏ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏. | –ü–æ–º–æ–≥–∞–µ—Ç –º–æ–¥–µ–ª–∏ –ª—É—á—à–µ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å. |
| `metrics=['accuracy']` | –û—Ü–µ–Ω–∏–≤–∞–µ—Ç –¥–æ–ª—é –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤. | –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–∏. |
| `fit()` | –ó–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è. | –û–±—É—á–∞–µ—Ç –º–æ–¥–µ–ª—å –Ω–∞ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É—è –µ—ë –æ—à–∏–±–∫–∏. |
| `epochs=10` | –ü–æ–≤—Ç–æ—Ä—è–µ—Ç –æ–±—É—á–µ–Ω–∏–µ 10 —Ä–∞–∑. | –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, —á—Ç–æ–±—ã –º–æ–¥–µ–ª—å —Ö–æ—Ä–æ—à–æ –∑–∞–ø–æ–º–Ω–∏–ª–∞ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏. |

–î–∞–≤–∞–π—Ç–µ –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞–∑–±–µ—Ä–µ–º –∫–æ–¥, —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å **–æ—Ü–µ–Ω–∫–æ–π –º–æ–¥–µ–ª–∏**:

### 1. **–ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –º–æ–¥–µ–ª–∏**

```python
y_true = []  # –ò—Å—Ç–∏–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –∫–ª–∞—Å—Å–æ–≤
y_pred = []  # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª—å—é –∫–ª–∞—Å—Å—ã

for images, labels in val_ds:
    preds = model.predict(images)  # –ü–æ–ª—É—á–∞–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–∏
    y_true.extend(labels.numpy())  # –î–æ–±–∞–≤–ª—è–µ–º –∏—Å—Ç–∏–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –∫–ª–∞—Å—Å–æ–≤
    y_pred.extend(np.argmax(preds, axis=1))  # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª–∞—Å—Å—ã
```

üìå **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**

1. **`y_true = []` –∏ `y_pred = []`** ‚Äì —Å–æ–∑–¥–∞—ë–º –¥–≤–∞ —Å–ø–∏—Å–∫–∞:  
   - `y_true` –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å **–∏—Å—Ç–∏–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –∫–ª–∞—Å—Å–æ–≤**, —Ç–æ –µ—Å—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –∫–ª–∞—Å—Å—ã, –∫ –∫–æ—Ç–æ—Ä—ã–º –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–µ.  
   - `y_pred` –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å **–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–∏**, —Ç–æ –µ—Å—Ç—å —Ç–µ –∫–ª–∞—Å—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–¥–µ–ª—å —Å—á–∏—Ç–∞–µ—Ç –Ω–∞–∏–±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω—ã–º–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.  

2. **–¶–∏–∫–ª –ø–æ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–º—É –¥–∞—Ç–∞—Å–µ—Ç—É (`for images, labels in val_ds`)** ‚Äì –ø—Ä–æ—Ö–æ–¥–∏–º –ø–æ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–º –¥–∞–Ω–Ω—ã–º `val_ds`, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –ø–∞—Ä—ã:  
   - **`images`** ‚Äì –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–¥–∞—é—Ç—Å—è –≤ –º–æ–¥–µ–ª—å –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è.  
   - **`labels`** ‚Äì —Ä–µ–∞–ª—å–Ω—ã–µ –º–µ—Ç–∫–∏ (–∫–ª–∞—Å—Å—ã) —ç—Ç–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

3. **`preds = model.predict(images)`** ‚Äì –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—Ç–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –º–æ–¥–µ–ª—å –¥–µ–ª–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è. –§—É–Ω–∫—Ü–∏—è `model.predict()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫ –∫–∞–∂–¥–æ–º—É –∫–ª–∞—Å—Å—É.  
   –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ —É –Ω–∞—Å 3 –∫–ª–∞—Å—Å–∞, –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –±—É–¥–µ—Ç —Å–ø–∏—Å–æ–∫ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π, –Ω–∞–ø—Ä–∏–º–µ—Ä: `[0.1, 0.7, 0.2]`. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º–æ–¥–µ–ª—å —Å—á–∏—Ç–∞–µ—Ç, —á—Ç–æ —ç—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –∫–æ –≤—Ç–æ—Ä–æ–º—É –∫–ª–∞—Å—Å—É —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 70%.

4. **`y_true.extend(labels.numpy())`** ‚Äì –¥–æ–±–∞–≤–ª—è–µ–º –≤ —Å–ø–∏—Å–æ–∫ –∏—Å—Ç–∏–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫ `y_true` —Ä–µ–∞–ª—å–Ω—ã–µ –º–µ—Ç–∫–∏ –∫–ª–∞—Å—Å–æ–≤ –∏–∑ `labels`. –ú–µ—Ç–æ–¥ `.numpy()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Ç–µ–Ω–∑–æ—Ä–∞ TensorFlow –≤ –æ–±—ã—á–Ω—ã–π –º–∞—Å—Å–∏–≤ NumPy.

5. **`y_pred.extend(np.argmax(preds, axis=1))`** ‚Äì –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –≤ **–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è**.  
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è `preds` —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –¥–ª—è –≤—Å–µ—Ö –∫–ª–∞—Å—Å–æ–≤.  
   - `np.argmax(preds, axis=1)` –Ω–∞—Ö–æ–¥–∏—Ç –∏–Ω–¥–µ–∫—Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –¥–ª—è –æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏: `[0.1, 0.7, 0.2]`, —Ç–æ `np.argmax(preds, axis=1)` –≤–µ—Ä–Ω—ë—Ç `1`, —Ç–∞–∫ –∫–∞–∫ –≤—Ç–æ—Ä–æ–π –∫–ª–∞—Å—Å (—Å –∏–Ω–¥–µ–∫—Å–æ–º 1) –∏–º–µ–µ—Ç –Ω–∞–∏–±–æ–ª—å—à—É—é –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å.  
   - –≠—Ç–∏ –∏–Ω–¥–µ–∫—Å—ã (–∫–ª–∞—Å—Å—ã) –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ —Å–ø–∏—Å–æ–∫ `y_pred`.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –≤ –∏—Ç–æ–≥–µ —É –Ω–∞—Å –±—É–¥—É—Ç –¥–≤–∞ —Å–ø–∏—Å–∫–∞:  
- **`y_true`** ‚Äì –∏—Å—Ç–∏–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –¥–ª—è –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–µ.  
- **`y_pred`** ‚Äì –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–∏ –¥–ª—è —ç—Ç–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

---

### 2. **–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã –æ—à–∏–±–æ–∫ (–º–∞—Ç—Ä–∏—Ü—ã –ø—É—Ç–∞–Ω–∏—Ü—ã)**

```python
conf_mat = confusion_matrix(y_true, y_pred)
sns.heatmap(conf_mat, annot=True, fmt="d", cmap="Blues", xticklabels=class_names, yticklabels=class_names)
plt.show()
```

üìå **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**

1. **`conf_mat = confusion_matrix(y_true, y_pred)`** ‚Äì —Å–æ–∑–¥–∞—ë–º **–º–∞—Ç—Ä–∏—Ü—É –ø—É—Ç–∞–Ω–∏—Ü—ã** —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ `confusion_matrix` –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `sklearn.metrics`.  
   - –≠—Ç–∞ –º–∞—Ç—Ä–∏—Ü–∞ –ø–æ–º–æ–≥–∞–µ—Ç –ø–æ–Ω—è—Ç—å, –∫–∞–∫ –º–æ–¥–µ–ª—å –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –æ–±—ä–µ–∫—Ç—ã, —Å—Ä–∞–≤–Ω–∏–≤–∞—è –∏—Å—Ç–∏–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ `y_true` —Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏ `y_pred`.  
   - –ú–∞—Ç—Ä–∏—Ü–∞ –ø—É—Ç–∞–Ω–∏—Ü—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∫–≤–∞–¥—Ä–∞—Ç–Ω—É—é —Ç–∞–±–ª–∏—Ü—É, –≥–¥–µ —Å—Ç—Ä–æ–∫–∏ ‚Äî —ç—Ç–æ **–∏—Å—Ç–∏–Ω–Ω—ã–µ –º–µ—Ç–∫–∏**, –∞ —Å—Ç–æ–ª–±—Ü—ã ‚Äî **–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–µ –º–µ—Ç–∫–∏**.  
   –ù–∞–ø—Ä–∏–º–µ—Ä:
   ```
   |          | Predicted Class 1 | Predicted Class 2 | Predicted Class 3 |
   |----------|-------------------|-------------------|-------------------|
   | True 1   | 50                | 3                 | 2                 |
   | True 2   | 5                 | 40                | 0                 |
   | True 3   | 1                 | 2                 | 60                |
   ```

   - –ó–Ω–∞—á–µ–Ω–∏–µ –≤ —è—á–µ–π–∫–µ (i, j) –º–∞—Ç—Ä–∏—Ü—ã –ø—É—Ç–∞–Ω–∏—Ü—ã –æ–∑–Ω–∞—á–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç **–∫ –∫–ª–∞—Å—Å—É i**, –Ω–æ –±—ã–ª–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ **–∫–ª–∞—Å—Å j**.

2. **`sns.heatmap(conf_mat, annot=True, fmt="d", cmap="Blues", xticklabels=class_names, yticklabels=class_names)`** ‚Äì —Å—Ç—Ä–æ–∏–º **—Ç–µ–ø–ª–æ–≤—É—é –∫–∞—Ä—Ç—É** —Å –ø–æ–º–æ—â—å—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `seaborn`.  
   - **`annot=True`** ‚Äì –¥–æ–±–∞–≤–ª—è–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –≤ —è—á–µ–π–∫–∏ –º–∞—Ç—Ä–∏—Ü—ã.  
   - **`fmt="d"`** ‚Äì —É–∫–∞–∑—ã–≤–∞–µ—Ç —Ñ–æ—Ä–º–∞—Ç —á–∏—Å–µ–ª (—Ü–µ–ª—ã–µ —á–∏—Å–ª–∞).  
   - **`cmap="Blues"`** ‚Äì –≤—ã–±–∏—Ä–∞–µ–º —Ü–≤–µ—Ç–æ–≤—É—é –ø–∞–ª–∏—Ç—Ä—É –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è (–≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —Å–∏–Ω–∏–π).  
   - **`xticklabels=class_names` –∏ `yticklabels=class_names`** ‚Äì –º–µ—Ç–∫–∏ –ø–æ –æ—Å—è–º X –∏ Y –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –∏–º–µ–Ω–∞ –∫–ª–∞—Å—Å–æ–≤.  
   –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –º–∞—Ç—Ä–∏—Ü–∞ –±—É–¥–µ—Ç –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –≤ –≤–∏–¥–µ —Ü–≤–µ—Ç–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã, –≥–¥–µ —Ç—ë–º–Ω—ã–µ –∫–ª–µ—Ç–∫–∏ –±—É–¥—É—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ **–±–æ–ª—å—à–∏–µ —á–∏—Å–ª–∞**.

3. **`plt.show()`** ‚Äì –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ç–µ–ø–ª–æ–≤—É—é –∫–∞—Ä—Ç—É –Ω–∞ —ç–∫—Ä–∞–Ω–µ.

---

### 3. **–í—ã–≤–æ–¥ –æ—Ç—á—ë—Ç–∞ –ø–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏**

```python
print(classification_report(y_true, y_pred, target_names=class_names))
```

üìå **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**

1. **`classification_report(y_true, y_pred, target_names=class_names)`** ‚Äì –≤—ã–≤–æ–¥–∏–º **–ø–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á—ë—Ç** –ø–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ `classification_report` –∏–∑ `sklearn.metrics`.  
   –≠—Ç–æ—Ç –æ—Ç—á—ë—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ—á–Ω–æ—Å—Ç–∏, –ø–æ–ª–Ω–æ—Ç–µ –∏ F1-–º–µ—Ä–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞.  

   –ù–∞–ø—Ä–∏–º–µ—Ä, –æ—Ç—á—ë—Ç –º–æ–∂–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫:
   ```
                 precision    recall  f1-score   support
   Class 1        0.90        0.85      0.87        100
   Class 2        0.80        0.75      0.77        100
   Class 3        0.95        0.96      0.95        100

   accuracy                           0.85        300
   macro avg       0.88        0.85      0.86        300
   weighted avg    0.88        0.85      0.86        300
   ```

2. **–û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:**
   - **Precision (—Ç–æ—á–Ω–æ—Å—Ç—å)** ‚Äì –¥–æ–ª—è –≤–µ—Ä–Ω—ã—Ö –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã—Ö –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö.  
   - **Recall (–ø–æ–ª–Ω–æ—Ç–∞)** ‚Äì –¥–æ–ª—è –≤–µ—Ä–Ω—ã—Ö –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤.  
   - **F1-score** ‚Äì –≥–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–æ–µ —Å—Ä–µ–¥–Ω–µ–µ –º–µ–∂–¥—É —Ç–æ—á–Ω–æ—Å—Ç—å—é –∏ –ø–æ–ª–Ω–æ—Ç–æ–π.  
   - **Support** ‚Äì –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –∫–∞–∂–¥–æ–º –∫–ª–∞—Å—Å–µ.

3. **`target_names=class_names`** ‚Äì —É–∫–∞–∑—ã–≤–∞–µ–º –∏–º–µ–Ω–∞ –∫–ª–∞—Å—Å–æ–≤, —á—Ç–æ–±—ã –æ–Ω–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∏—Å—å –≤ –æ—Ç—á—ë—Ç–µ –≤–º–µ—Å—Ç–æ —á–∏—Å–ª–æ–≤—ã—Ö –º–µ—Ç–æ–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `Class 1`, `Class 2`).

---

### **–ò—Ç–æ–≥:**
- –ú—ã –ø–æ–ª—É—á–∞–µ–º **–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–∏** –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º –∏—Ö —Å –∏—Å—Ç–∏–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏ –∏ —Å—Ç—Ä–æ–∏–º **–º–∞—Ç—Ä–∏—Ü—É –ø—É—Ç–∞–Ω–∏—Ü—ã**, —á—Ç–æ–±—ã –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏.  
- –¢–∞–∫–∂–µ –≤—ã–≤–æ–¥–∏–º **–ø–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á—ë—Ç** –ø–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –º–æ–¥–µ–ª—å —Ä–∞–∑–ª–∏—á–∞–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∫–ª–∞—Å—Å—ã –∏ –≥–¥–µ —É –Ω–µ—ë –≤–æ–∑–Ω–∏–∫–∞—é—Ç —Ç—Ä—É–¥–Ω–æ—Å—Ç–∏.

–î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º, —á—Ç–æ –æ–∑–Ω–∞—á–∞—é—Ç —Å—Ç—Ä–æ–∫–∏ –∏–∑ –æ—Ç—á–µ—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –º—ã –≤—ã–≤–æ–¥–∏–º —Å –ø–æ–º–æ—â—å—é `classification_report`.

### –ü—Ä–∏–º–µ—Ä –æ—Ç—á–µ—Ç–∞:

```
                 precision    recall  f1-score   support
Class 1        0.90        0.85      0.87        100
Class 2        0.80        0.75      0.77        100
Class 3        0.95        0.96      0.95        100

accuracy                           0.85        300
macro avg       0.88        0.85      0.86        300
weighted avg    0.88        0.85      0.86        300
```

### 1. **Precision (—Ç–æ—á–Ω–æ—Å—Ç—å)**:
- –¢–æ—á–Ω–æ—Å—Ç—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ –≤–µ—Ä–Ω—ã —Ç–µ –ø—Ä–æ–≥–Ω–æ–∑—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–¥–µ–ª—å —Å–¥–µ–ª–∞–ª–∞ –∫–∞–∫ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ (—Ç–æ –µ—Å—Ç—å, –∫–æ–≥–¥–∞ –æ–Ω–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–ª–∞, —á—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É –∫–ª–∞—Å—Å—É). –≠—Ç–æ –º–µ—Ä–∞ —Ç–æ–≥–æ, —Å–∫–æ–ª—å–∫–æ –∏–∑ –≤—Å–µ—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã—Ö –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —è–≤–ª—è—é—Ç—Å—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º–∏.
- –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è **Class 1** —Ç–æ—á–Ω–æ—Å—Ç—å —Ä–∞–≤–Ω–∞ **0.90**, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ 90% –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–ª–∞ –∫–∞–∫ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏–µ –∫ Class 1, –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç —ç—Ç–æ–º—É –∫–ª–∞—Å—Å—É.

### 2. **Recall (–ø–æ–ª–Ω–æ—Ç–∞)**:
- –ü–æ–ª–Ω–æ—Ç–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ –º–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –≤—Å–µ –∏—Å—Ç–∏–Ω–Ω—ã–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã (—Ç–æ –µ—Å—Ç—å, —Å–∫–æ–ª—å–∫–æ –∏–∑ –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ –º–æ–¥–µ–ª—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–ª–∞ –∫–∞–∫ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏–µ —ç—Ç–æ–º—É –∫–ª–∞—Å—Å—É).
- –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è **Class 1** –ø–æ–ª–Ω–æ—Ç–∞ —Ä–∞–≤–Ω–∞ **0.85**, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º–æ–¥–µ–ª—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–ª–∞ 85% –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç –∫ Class 1.

### 3. **F1-score**:
- F1-score ‚Äî —ç—Ç–æ –≥–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–æ–µ —Å—Ä–µ–¥–Ω–µ–µ –º–µ–∂–¥—É —Ç–æ—á–Ω–æ—Å—Ç—å—é –∏ –ø–æ–ª–Ω–æ—Ç–æ–π, –∫–æ—Ç–æ—Ä–æ–µ –¥–∞—ë—Ç –±–æ–ª–µ–µ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—É—é –æ—Ü–µ–Ω–∫—É, –æ—Å–æ–±–µ–Ω–Ω–æ –∫–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω—ã.
- –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è **Class 1** F1-score —Ä–∞–≤–µ–Ω **0.87**, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –º–µ—Ç—Ä–∏–∫–æ–π, –∫–æ–º–±–∏–Ω–∏—Ä—É—é—â–µ–π –∫–∞–∫ —Ç–æ—á–Ω–æ—Å—Ç—å, —Ç–∞–∫ –∏ –ø–æ–ª–Ω–æ—Ç—É.

### 4. **Support**:
- –≠—Ç–æ –ø—Ä–æ—Å—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏. –≠—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–º–µ—Ä–æ–≤, –ø–æ –∫–æ—Ç–æ—Ä—ã–º –º–æ–¥–µ–ª—å –¥–µ–ª–∞–ª–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è.
- –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è **Class 1** support —Ä–∞–≤–µ–Ω **100**, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö –±—ã–ª–æ 100 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏—Ö –∫ Class 1.

---

### –°—Ç—Ä–æ–∫–∏ "accuracy", "macro avg" –∏ "weighted avg":

1. **accuracy**:
   - **accuracy = 0.85** ‚Äî —ç—Ç–æ –æ–±—â–∞—è **—Ç–æ—á–Ω–æ—Å—Ç—å** –º–æ–¥–µ–ª–∏ –Ω–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –º–æ–¥–µ–ª—å –≤–µ—Ä–Ω–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–ª–∞ **85%** –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–µ.
   - –≠—Ç–∞ –º–µ—Ç—Ä–∏–∫–∞ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫:
     \[
     \text{Accuracy} = \frac{\text{–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–µ—Ä–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π}}{\text{–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–º–µ—Ä–æ–≤}}
     \]
   - –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º–æ–¥–µ–ª—å –≤–µ—Ä–Ω–æ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–ª–∞ 255 –∏–∑ 300 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (85%).

2. **macro avg**:
   - **Macro average (—Å—Ä–µ–¥–Ω–µ–µ –ø–æ –∫–ª–∞—Å—Å–∞–º)** ‚Äî —ç—Ç–æ —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏, –ø–æ–ª–Ω–æ—Ç—ã –∏ F1-–º–µ—Ä—ã –ø–æ –≤—Å–µ–º –∫–ª–∞—Å—Å–∞–º, –ø—Ä–∏ —ç—Ç–æ–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞ –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏ —Å—á–∏—Ç–∞—é—Ç—Å—è —Ä–∞–≤–Ω—ã–º–∏. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –∫–∞–∂–¥—ã–π –∫–ª–∞—Å—Å –≤–Ω–æ—Å–∏—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –≤–∫–ª–∞–¥ –≤ –∏—Ç–æ–≥–æ–≤—É—é –º–µ—Ç—Ä–∏–∫—É, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, —Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–æ–≤ –±—ã–ª–æ –≤ –∫–∞–∂–¥–æ–º –∫–ª–∞—Å—Å–µ.
   - –ù–∞–ø—Ä–∏–º–µ—Ä, **macro avg precision = 0.88** ‚Äî —ç—Ç–æ —Å—Ä–µ–¥–Ω—è—è —Ç–æ—á–Ω–æ—Å—Ç—å –ø–æ –≤—Å–µ–º –∫–ª–∞—Å—Å–∞–º. –¢–æ –µ—Å—Ç—å, –µ—Å–ª–∏ —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å –¥–ª—è –≤—Å–µ—Ö –∫–ª–∞—Å—Å–æ–≤ –∏ –≤–∑—è—Ç—å –∏—Ö —Å—Ä–µ–¥–Ω–µ–µ, —Ç–æ –ø–æ–ª—É—á–∏—Ç—Å—è **88%**.
   - **macro avg recall = 0.85** ‚Äî —Å—Ä–µ–¥–Ω—è—è –ø–æ–ª–Ω–æ—Ç–∞ –ø–æ –≤—Å–µ–º –∫–ª–∞—Å—Å–∞–º.
   - **macro avg f1-score = 0.86** ‚Äî —Å—Ä–µ–¥–Ω—è—è F1-–º–µ—Ç—Ä–∏–∫–∞ –ø–æ –≤—Å–µ–º –∫–ª–∞—Å—Å–∞–º.

3. **weighted avg**:
   - **Weighted average (–≤–∑–≤–µ—à–µ–Ω–Ω–æ–µ —Å—Ä–µ–¥–Ω–µ–µ)** ‚Äî —ç—Ç–æ —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ –≤—Å–µ–º –∫–ª–∞—Å—Å–∞–º, –Ω–æ —Å —É—á—ë—Ç–æ–º —Ç–æ–≥–æ, —Å–∫–æ–ª—å–∫–æ –æ–±—ä–µ–∫—Ç–æ–≤ –±—ã–ª–æ –≤ –∫–∞–∂–¥–æ–º –∫–ª–∞—Å—Å–µ. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∫–ª–∞—Å—Å—ã —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø—Ä–∏–º–µ—Ä–æ–≤ –±—É–¥—É—Ç –≤–ª–∏—è—Ç—å –Ω–∞ –∏—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±–æ–ª—å—à–µ, —á–µ–º –∫–ª–∞—Å—Å—ã —Å –º–µ–Ω—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø—Ä–∏–º–µ—Ä–æ–≤.
   - –ù–∞–ø—Ä–∏–º–µ—Ä, **weighted avg precision = 0.88** ‚Äî —ç—Ç–æ –≤–∑–≤–µ—à–µ–Ω–Ω–æ–µ —Å—Ä–µ–¥–Ω–µ–µ –ø–æ —Ç–æ—á–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä–æ–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–º–µ—Ä–æ–≤ –≤ –∫–∞–∂–¥–æ–º –∫–ª–∞—Å—Å–µ.
   - **weighted avg recall = 0.85** ‚Äî –≤–∑–≤–µ—à–µ–Ω–Ω–∞—è –ø–æ–ª–Ω–æ—Ç–∞ –ø–æ –≤—Å–µ–º –∫–ª–∞—Å—Å–∞–º.
   - **weighted avg f1-score = 0.86** ‚Äî –≤–∑–≤–µ—à–µ–Ω–Ω–∞—è F1-–º–µ—Ç—Ä–∏–∫–∞ –ø–æ –≤—Å–µ–º –∫–ª–∞—Å—Å–∞–º.

---

### **–ü–æ–¥—ã—Ç–æ–∂–∏–º:**

- **`accuracy = 0.85`** ‚Äî —ç—Ç–æ –æ–±—â–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏, –æ–Ω–∞ —Ä–∞–≤–Ω–∞ 85%.
- **`macro avg`** ‚Äî —ç—Ç–æ —Å—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫ –ø–æ –≤—Å–µ–º –∫–ª–∞—Å—Å–∞–º, –≥–¥–µ –∫–∞–∂–¥—ã–π –∫–ª–∞—Å—Å –∏–º–µ–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –≤–µ—Å.
- **`weighted avg`** ‚Äî —ç—Ç–æ —Å—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫, –≥–¥–µ –∫–∞–∂–¥—ã–π –∫–ª–∞—Å—Å –≤–∑–≤–µ—à–µ–Ω –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø—Ä–∏–º–µ—Ä–æ–≤ –≤ –∫–ª–∞—Å—Å–µ.

–ü–µ—Ä–µ–¥–∞—á–∞ `val_ds` –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä `validation_data` –ø—Ä–∏ –≤—ã–∑–æ–≤–µ `model.fit()` –≤–∞–∂–Ω–∞ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –º–æ–¥–µ–ª—å –º–æ–≥–ª–∞ –≤—ã–ø–æ–ª–Ω—è—Ç—å –æ—Ü–µ–Ω–∫—É –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –∫–∞–∂–¥–æ–π —ç–ø–æ—Ö–µ –æ–±—É—á–µ–Ω–∏—è. 

–í–æ—Ç –∫–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä `validation_data`?

- **`train_ds`** ‚Äî —ç—Ç–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –º–æ–¥–µ–ª—å —É—á–∏—Ç—Å—è, –æ–±–Ω–æ–≤–ª—è—è —Å–≤–æ–∏ –≤–µ—Å–∞ –∏ –º–∏–Ω–∏–º–∏–∑–∏—Ä—É—è —Ñ—É–Ω–∫—Ü–∏—é –ø–æ—Ç–µ—Ä—å. 
- **`val_ds`** ‚Äî —ç—Ç–æ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏ –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ (–Ω–∞ –∫–∞–∂–¥–æ–π —ç–ø–æ—Ö–µ) –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—É—á–µ–Ω–∏—è.

–ö–æ–≥–¥–∞ –≤—ã –ø–µ—Ä–µ–¥–∞–µ—Ç–µ `val_ds` –≤ `validation_data`, —ç—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç Keras –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. **–ü—Ä–æ–≤–æ–¥–∏—Ç—å –æ—Ü–µ–Ω–∫—É –º–æ–¥–µ–ª–∏** –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —ç–ø–æ—Ö–∏.
2. **–û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏** (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–æ—á–Ω–æ—Å—Ç—å –∏–ª–∏ –ø–æ—Ç–µ—Ä—é) –Ω–µ —Ç–æ–ª—å–∫–æ –Ω–∞ –æ–±—É—á–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö, –Ω–æ –∏ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã—Ö. –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –≤–∞–º —É–≤–∏–¥–µ—Ç—å, –∫–∞–∫ –º–æ–¥–µ–ª—å –æ–±–æ–±—â–∞–µ—Ç—Å—è –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω–∞ –Ω–µ –≤–∏–¥–µ–ª–∞ –≤–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è.

### –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?

1. **–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è (overfitting):**
   - –ë–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –º–æ–¥–µ–ª—å –º–æ–∂–µ—Ç —Å–ª–∏—à–∫–æ–º –ø–æ–¥—Å—Ç—Ä–æ–∏—Ç—å—Å—è –ø–æ–¥ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –∑–∞–ø–æ–º–∏–Ω–∞—è –∏—Ö –≤–º–µ—Å—Ç–æ —Ç–æ–≥–æ, —á—Ç–æ–±—ã —É—á–∏—Ç—å—Å—è –∏–∑–≤–ª–µ–∫–∞—Ç—å –æ–±–æ–±—â–µ–Ω–Ω—ã–µ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏.
   - –ò—Å–ø–æ–ª—å–∑—É—è –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –≤—ã –º–æ–∂–µ—Ç–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å, –Ω–∞—á–∏–Ω–∞–µ—Ç –ª–∏ –º–æ–¥–µ–ª—å –ø–µ—Ä–µ–æ–±—É—á–∞—Ç—å—Å—è. –ï—Å–ª–∏ —Ç–æ—á–Ω–æ—Å—Ç—å –Ω–∞ –æ–±—É—á–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞—Å—Ç–∏, –Ω–æ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã—Ö –æ—Å—Ç–∞—ë—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π –∏–ª–∏ –ø–∞–¥–∞–µ—Ç, —ç—Ç–æ —Å–∏–≥–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–∏.
   
2. **–û—Ü–µ–Ω–∫–∞ –æ–±–æ–±—â–∞—é—â–∏—Ö —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π –º–æ–¥–µ–ª–∏:**
   - –í–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–∞—é—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ —Ç–æ–º, –∫–∞–∫ —Ö–æ—Ä–æ—à–æ –º–æ–¥–µ–ª—å –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –¥–ª—è –æ–±—É—á–µ–Ω–∏—è. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å –µ—ë —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –∫ –æ–±–æ–±—â–µ–Ω–∏—é.

3. **–ü–æ–¥–±–æ—Ä –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:**
   - –ù–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏, —Ç–∞–∫–∏–µ –∫–∞–∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö, —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è, –∏–ª–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –º–æ–¥–µ–ª–∏.

### –ü—Ä–∏–º–µ—Ä:

–ö–æ–≥–¥–∞ –≤—ã –ø–µ—Ä–µ–¥–∞–µ—Ç–µ `val_ds` –≤ `validation_data`, Keras –±—É–¥–µ—Ç –≤—ã–≤–æ–¥–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –º–µ—Ç—Ä–∏–∫–∞—Ö –∫–∞–∫ –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —Ç–∞–∫ –∏ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã—Ö. –ù–∞–ø—Ä–∏–º–µ—Ä:

```python
Epoch 1/10
100/100 [==============================] - 5s 50ms/step - loss: 0.2301 - accuracy: 0.9300 - val_loss: 0.3053 - val_accuracy: 0.9200
```

–ó–¥–µ—Å—å:
- **`loss`** –∏ **`accuracy`** ‚Äî —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ—Ç–µ—Ä—å –∏ —Ç–æ—á–Ω–æ—Å—Ç–∏ –¥–ª—è –æ–±—É—á–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö.
- **`val_loss`** –∏ **`val_accuracy`** ‚Äî —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ—Ç–µ—Ä—å –∏ —Ç–æ—á–Ω–æ—Å—Ç–∏ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

–≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –≤–∞–º –≤–∏–¥–µ—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ, –∫–∞–∫ –º–æ–¥–µ–ª—å –æ–±—É—á–∞–µ—Ç—Å—è, –Ω–æ –∏ –∫–∞–∫ –æ–Ω–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
